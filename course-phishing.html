<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing Awareness Course | CyberTech</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="js/settings-manager.js"></script>
<script src="js/course-updater.js"></script>
<script src="js/ensure-lesson.js"></script>
<script src="js/direct-lesson-injector.js"></script>

<!-- PERMANENT OVERRIDE: Block video for Spot the Phish exercise -->
<script>
// Override openVideoModal to block video for reading lessons and Spot the Phish exercise
const originalOpenVideoModal = window.openVideoModal;
window.openVideoModal = function(title, videoId, duration) {
    // Block video for reading lessons
    if (title === 'Common Types of Phishing Attacks') {
        console.log('◆◆Blocking video for reading lesson:', title);
        return; // Don't show video for reading lessons
    }
    
    // Block video for Spot the Phish exercise
    if (title === 'Interactive Exercise: Spot the Phish' || title.includes('Spot the Phish')) {
        console.log('◆◆Blocking video for Interactive Exercise - opening quiz instead');
        if (typeof window.openSpotThePhishExercise === 'function') {
            window.openSpotThePhishExercise();
        }
        return;
    }
    
    // Call original function for all other videos
    if (originalOpenVideoModal) {
        originalOpenVideoModal.apply(this, arguments);
    }
};

// Also override any direct video modal opening
const originalVideoModal = document.getElementById('videoModal');
if (originalVideoModal) {
    const originalDisplay = originalVideoModal.style.display;
    Object.defineProperty(originalVideoModal.style, 'display', {
        set: function(value) {
            // Check if we're trying to show video for reading lessons
            const videoTitle = document.getElementById('videoTitle')?.textContent;
            if (value === 'block' && (videoTitle === 'Common Types of Phishing Attacks')) {
                console.log('◆◆Blocking video modal for reading lesson:', videoTitle);
                return; // Don't show the modal
            }
            originalDisplay = value;
        },
        get: function() {
            return originalDisplay;
        }
    });
}

// Also override any video element creation for this exercise
const originalCreateElement = document.createElement;
document.createElement = function(tagName) {
    const element = originalCreateElement.call(document, tagName);
    
    // If creating a video element and we're in the exercise context, block it
    if (tagName.toLowerCase() === 'video') {
        const currentModal = document.querySelector('#spot-phish-quiz-modal');
        if (currentModal && currentModal.style.display !== 'none') {
            console.log('◆◆Blocking video element creation in exercise');
            // Return a dummy div instead of video
            const dummyDiv = originalCreateElement.call(document, 'div');
            dummyDiv.style.display = 'none';
            return dummyDiv;
        }
    }
    
    return element;
};

// Block any video playback in the exercise modal
document.addEventListener('DOMContentLoaded', function() {
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList') {
                mutation.addedNodes.forEach(function(node) {
                    if (node.nodeType === 1 && node.id === 'spot-phish-quiz-modal') {
                        // Block any video elements inside the exercise modal
                        const videos = node.querySelectorAll('video');
                        videos.forEach(function(video) {
                            console.log('◆◆Blocking video in exercise modal');
                            video.pause();
                            video.style.display = 'none';
                            video.remove();
                        });
                    }
                });
            }
        });
    });
    
    observer.observe(document.body, {
        childList: true,
        subtree: true
    });
});

// Also override any direct lesson click handlers
document.addEventListener('DOMContentLoaded', function() {
    // Handle Spot the Phish exercise
    const spotPhishLesson = document.getElementById('spot-phish-lesson');
    if (spotPhishLesson) {
        // Remove any existing click handlers
        const newLesson = spotPhishLesson.cloneNode(true);
        spotPhishLesson.parentNode.replaceChild(newLesson, spotPhishLesson);
        
        // Add our specific handler
        newLesson.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('Opening Spot the Phish exercise directly');
            
            // STOP ANY VIDEOS BEFORE OPENING EXERCISE
            const allVideos = document.querySelectorAll('video');
            allVideos.forEach(function(video) {
                video.pause();
                video.currentTime = 0;
                video.muted = true;
            });
            
            if (typeof window.openSpotThePhishExercise === 'function') {
                window.openSpotThePhishExercise();
            }
        });
    }
    
    // Handle all lessons - both video and reading
    const allLessons = document.querySelectorAll('.lesson-info');
    allLessons.forEach(lesson => {
        const lessonTitle = lesson.querySelector('span')?.textContent;
        
        // Check if this is a reading lesson
        if (lessonTitle === 'Common Types of Phishing Attacks') {
            // Configure as reading lesson
            lesson.classList.remove('video-lesson');
            lesson.removeAttribute('id');
            lesson.onclick = null;
            
            // Set reading icon
            const icon = lesson.querySelector('i');
            if (icon && !icon.classList.contains('fa-file-alt')) {
                icon.className = 'fas fa-file-alt';
            }
            
            // Add reading-specific handler
            lesson.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('Reading lesson clicked:', lessonTitle);
                
                // Toggle expandable content
                const expandedContent = this.parentElement.querySelector('.lesson-expanded-content');
                if (expandedContent) {
                    const isExpanded = expandedContent.style.display !== 'none';
                    expandedContent.style.display = isExpanded ? 'none' : 'block';
                    
                    const expandIcon = this.querySelector('.expand-icon');
                    if (expandIcon) {
                        expandIcon.style.transform = isExpanded ? 'rotate(0deg)' : 'rotate(180deg)';
                    }
                }
            });
            
            console.log('✅ Reading lesson configured:', lessonTitle);
        }
    });
    
    // Also override any global video functions that might be called
    if (typeof window.playVideo === 'function') {
        const originalPlayVideo = window.playVideo;
        window.playVideo = function(videoId, title) {
            if (title && title.includes('Spot the Phish')) {
                console.log('◆◆Blocking playVideo for Spot the Phish exercise');
                if (typeof window.openSpotThePhishExercise === 'function') {
                    window.openSpotThePhishExercise();
                }
                return;
            }
            return originalPlayVideo.apply(this, arguments);
        };
    }
});

// Ensure the exercise is always available
document.addEventListener('DOMContentLoaded', function() {
    // Save exercise data permanently
    const exerciseData = {
        courseName: 'Phishing Awareness',
        lessonName: 'Interactive Exercise: Spot the Phish',
        type: 'interactive',
        duration: '13 min'
    };
    
    // Save to localStorage to ensure persistence
    const existingExercises = JSON.parse(localStorage.getItem('cybertech_interactive_exercises') || '[]');
    const exerciseExists = existingExercises.find(ex => 
        ex.courseName === exerciseData.courseName && 
        ex.lessonName === exerciseData.lessonName
    );
    
    if (!exerciseExists) {
        existingExercises.push(exerciseData);
        localStorage.setItem('cybertech_interactive_exercises', JSON.stringify(existingExercises));
    }
    
    console.log('✅ Spot the Phish exercise permanently saved');
    
    // Also save to course data for persistence
    const courseData = JSON.parse(localStorage.getItem('cybertech_courses') || '[]');
    const phishingCourse = courseData.find(course => course.name === 'Phishing Awareness');
    
    if (phishingCourse) {
        const exerciseExists = phishingCourse.lessons.find(lesson => 
            lesson.title === 'Interactive Exercise: Spot the Phish'
        );
        
        if (!exerciseExists) {
            phishingCourse.lessons.push({
                id: 'spot-phish-exercise',
                title: 'Interactive Exercise: Spot the Phish',
                duration: '13 min',
                type: 'interactive'
            });
            localStorage.setItem('cybertech_courses', JSON.stringify(courseData));
            console.log('✅ Exercise added to course data');
        }
    }
});
</script>

    <!-- Phishing Types Modal -->
    <div id="phishingTypesModal" class="reading-modal">
        <div class="reading-modal-content">
            <div class="reading-modal-header">
                <h3>Common Types of Phishing Attacks</h3>
                <span class="reading-modal-close" onclick="closePhishingTypesModal()">&times;</span>
            </div>
            <div class="phishing-types-container">
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h4>Email Phishing</h4>
                    <p>The most common type where attackers send fraudulent emails impersonating legitimate organizations.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Emails claiming to be from your bank requesting urgent account verification.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-fish"></i>
                    </div>
                    <h4>Spear Phishing</h4>
                    <p>Targeted attacks using personalized information to appear more convincing to specific individuals.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Email appearing to be from your CEO requesting an urgent wire transfer.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-crown" style="color: white; font-size: 18px;"></i>
                    </div>
                    <h4>Whaling</h4>
                    <p>Highly targeted phishing attacks specifically aimed at senior executives and high-profile targets.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Fake legal document requiring immediate executive attention and action.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h4>Smishing (SMS Phishing)</h4>
                    <p>Phishing attacks conducted through SMS text messages on mobile devices.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Text message claiming you've won a prize and need to click a link to claim it.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <h4>Vishing (Voice Phishing)</h4>
                    <p>Phone-based phishing attacks using voice calls to deceive victims.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Calls claiming to be from tech support about your computer being infected.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <h4>Clone Phishing</h4>
                    <p>Duplicating legitimate emails with malicious attachments or links.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Copy of a real delivery notification email with modified tracking link.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Video Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-content">
            <div class="video-modal-header">
                <h3 id="videoTitle">Video Title</h3>
                <button class="close-video-modal" onclick="closeVideoModal()">&times;</button>
            </div>
            <div class="video-modal-body">
                <div class="video-container" style="position: relative; background: #000; min-height: 400px;">
                    <video id="courseVideo" controls controlsList="nodownload" playsinline preload="auto" style="width: 100%; height: 400px; background: #000; display: block; object-fit: contain;">
                        <source src="videos/courses/Phishing 1.mp4" type="video/mp4">
                        <p>Your browser does not support the video tag.</p>
                    </video>
                </div>
                <div class="video-info">
                    <p id="videoDuration">Duration: <span id="durationText">0 min</span></p>
                    <p>Click play to start the lesson. You can pause and resume at any time.</p>
                </div>
            </div>
        </div>
    </div>

    <style>
        .video-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .video-modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            width: 90%;
            max-width: 800px;
            border-radius: 8px;
            position: relative;
        }

        .video-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-video-modal {
            background: none;
            border: none;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

        .close-video-modal:hover {
            color: #000;
        }

        .video-container {
            margin-bottom: 20px;
            position: relative;
            background-color: #000;
            min-height: 400px;
            width: 100%;
            overflow: hidden;
            border-radius: 8px;
        }

        .video-info {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        #courseVideo {
            display: block !important;
            width: 100% !important;
            height: 400px !important;
            background: #000 !important;
            object-fit: contain !important;
            margin: 0;
            border: none;
            box-shadow: none;
            opacity: 1 !important;
            visibility: visible !important;
            z-index: 10 !important;
        }

        .video-container {
            position: relative !important;
            background: #000 !important;
            min-height: 400px !important;
            overflow: hidden !important;
            border-radius: 4px;
            margin-bottom: 20px;
        }
    </style>
    <script>
        // Make sure the course content and videos are always up to date with admin changes
        document.addEventListener('DOMContentLoaded', function() {
            // Check for new videos on page load
            loadDynamicVideos();
            
            // Set up periodic check for new videos (every 30 seconds)
            setInterval(function() {
                console.log('Checking for new video updates...');
                loadDynamicVideos();
            }, 30000);
            
            // Listen for video updates from admin
            window.addEventListener('videoUpdated', function(event) {
                console.log('Video update detected:', event.detail);
                loadDynamicVideos();
            });
            
            // Watch localStorage for video changes
            window.addEventListener('storage', function(e) {
                if (e.key && (
                    e.key.startsWith('video_data_') || 
                    e.key === 'cybertech_user_videos'
                )) {
                    console.log('Video storage updated:', e.key);
                    loadDynamicVideos();
                }
            });
            // Force refresh course data
            if (localStorage.getItem('cybertech_admin_courses')) {
                console.log('Loading latest course data from admin settings');
                
                // Immediately check for template updates
                if (typeof checkAndApplyTemplateUpdates === 'function') {
                    console.log('Checking for template updates on page load...');
                    checkAndApplyTemplateUpdates();
                }
                
                // Set up a MutationObserver to detect when course content is updated
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList' && 
                            (mutation.target.classList.contains('course-description') || 
                             mutation.target.classList.contains('module-title') ||
                             mutation.target.classList.contains('module-duration'))) {
                            console.log('Course content updated by course-updater.js');
                        }
                    });
                });
                
                // Observe the course description and module titles for changes
                observer.observe(document.getElementById('main-course-description'), { childList: true, subtree: true });
                document.querySelectorAll('.module-title, .module-duration').forEach(el => {
                    observer.observe(el, { childList: true, subtree: true });
                });
                
                // Update the timestamp to force a refresh, but don't delete the course data
                localStorage.setItem('cybertech_admin_courses_last_update', new Date().getTime().toString());
                console.log('Updated timestamp to refresh course data without deleting existing courses');
                
                // Add timestamp to ensure fresh loading
                localStorage.setItem('phishing_page_refresh', new Date().getTime());
                
                // Directly update the header section with the latest data from localStorage
                try {
                    const courses = JSON.parse(localStorage.getItem('cybertech_admin_courses')) || [];
                    const currentCourse = courses.find(c => 
                        c.name.toLowerCase().includes('phishing') || 
                        window.location.pathname.includes('phishing')
                    );
                    
                    if (currentCourse) {
                        console.log('Found course data:', currentCourse.name);
                        
                        // Update course title
                        document.getElementById('course-title').textContent = currentCourse.name;
                        
                        // Update course duration
                        document.getElementById('course-duration').innerHTML = 
                            `<i class="fas fa-clock"></i> ${currentCourse.duration} hours`;
                        
                        // Update enrolled count
                        document.getElementById('course-enrolled').innerHTML = 
                            `<i class="fas fa-users"></i> ${currentCourse.enrolled.toLocaleString()} enrolled`;
                        
                        // Update description ONLY (not overview)
                        const mainDescriptionElement = document.getElementById('main-course-description');
                        if (mainDescriptionElement && currentCourse.description) {
                            mainDescriptionElement.textContent = currentCourse.description;
                            console.log('Updated course description with:', currentCourse.description);
                        }
                        
                        // Do NOT update the course-overview-text as it should show the comprehensive version
                        console.log('Keeping comprehensive overview text unchanged');
                            
                        // Update the page title
                        document.title = `${currentCourse.name} Course | CyberTech`;
                    }
                } catch (error) {
                    console.error('Error updating course header:', error);
                }
            }
        });
    </script>
    <style>
        /* Reading Modal Styles */
        .reading-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            overflow: auto;
        }
        
        .reading-modal-content {
            position: relative;
            background-color: #fff;
            margin: 5% auto;
            width: 90%;
            max-width: 1200px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .reading-modal-header {
            background-color: #4e54c8;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .reading-modal-header h3 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }
        
        .reading-modal-close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .reading-modal-close:hover {
            color: #ddd;
        }
        
        .phishing-types-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .phishing-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
            position: relative;
        }
        
        .phishing-icon {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 40px;
            height: 40px;
            background: #4e54c8;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .phishing-card h4 {
            margin: 0 0 15px 60px;
            color: #333;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .phishing-card p {
            margin: 0 0 20px 60px;
            color: #666;
            line-height: 1.6;
        }
        
        .example-box {
            background: #f8f9fa;
            border-left: 4px solid #4e54c8;
            padding: 15px;
            margin-left: 60px;
            border-radius: 5px;
        }
        
        .example-box h5 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .example-box h5 i {
            color: #ffc107;
        }
        
        .example-box p {
            margin: 0;
            color: #666;
            line-height: 1.5;
        }

        /* Platform name styling for navigation and footer */
        .platform-name-styled .cyber-part {
            color: #4e54c8; /* Blue color */
            font-weight: 600;
        }
        
        .platform-name-styled .tech-part {
            color: #43d477; /* Green color */
            font-weight: 600;
        }
        
        /* Navigation logo styling */
        .navbar .logo h1 {
            text-decoration: none;
        }
        
        .navbar .logo h1 a {
            text-decoration: none;
        }
        
        .navbar .logo h1 .cyber-part {
            color: #4e54c8; /* Blue color */
            font-weight: 600;
        }
        
        .navbar .logo h1 .tech-part {
            color: #43d477; /* Green color */
            font-weight: 600;
        }
        
        /* Footer logo styling */
        .footer-col h3 .cyber-part {
            color: #4e54c8; /* Blue color */
            font-weight: 600;
        }
        
        .footer-col h3 .tech-part {
            color: #43d477; /* Green color */
            font-weight: 600;
        }
        
        /* Video Lesson Styles */
        .video-lesson {
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 5px;
            padding: 5px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .video-lesson i.fa-play-circle {
            font-size: 1.2em;
            color: #007bff;
            transition: all 0.3s ease;
        }
        
        .video-lesson:hover {
            transform: translateX(5px);
        }
        
        .video-lesson:hover i.fa-play-circle {
            transform: scale(1.2);
            color: #0056b3;
        }
        
        .video-lesson span {
            flex-grow: 1;
        }
        
        .video-lesson:hover .fas.fa-play-circle {
            color: #007bff;
            transform: scale(1.1);
        }
        
        /* Admin video styling */
        .video-lesson.admin-video {
            transition: all 0.3s ease;
        }
        
        .video-lesson.admin-video:hover {
            transform: translateX(5px);
        }
        
        .video-lesson.admin-video small {
            font-size: 0.8em;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
        }
        
        /* Video Modal Styles */
        .video-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }
        
        .video-modal-content {
            background-color: #fff;
            margin: 5% auto;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .video-modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .video-modal-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }
        
        .close-video-modal {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            line-height: 1;
            transition: transform 0.2s ease;
        }
        
        .close-video-modal:hover {
            transform: scale(1.1);
        }
        
        .video-modal-body {
            padding: 20px;
        }
        
        .video-container {
            width: 100%;
            margin-bottom: 20px;
        }
        
        .video-container video {
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .video-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        .video-info p {
            margin: 5px 0;
            color: #666;
        }
        
        #durationText {
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="logo">
                <h1 class="platform-name-styled"><a href="index.html"><span class="cyber-part">Cyber</span><span class="tech-part">Tech</span></a></h1>
            </div>
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link-blue">Home</a></li>
                <li><a href="index.html#courses" class="nav-link-green active">Courses</a></li>
                <li><a href="about.html" class="nav-link-green">About</a></li>
                <li><a href="contact.html" class="nav-link-blue">Contact</a></li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Course Header -->
    <section class="course-header">
        <div class="container">
            <div class="course-header-content">
                <div class="course-badge beginner small-badge">Beginner</div>
                <h1 id="course-title">Phishing Awareness</h1>
                <div class="course-meta">
                    <span id="course-duration"><i class="fas fa-clock"></i> 2 hours</span>
                    <span id="course-enrolled"><i class="fas fa-users"></i> 1,245 enrolled</span>
                    <span><i class="fas fa-star"></i> 4.8 (235 reviews)</span>
                    <span><i class="fas fa-certificate"></i> Certificate Included</span>
                </div>
                <p class="course-description" id="main-course-description">
                    Learn to identify and avoid phishing attempts in your daily work environment
                </p>
                <div class="course-actions">
                    <a href="#overview" class="btn btn-primary" onclick="showTab('overview')">Start Learning</a>
                    <a href="certificate.html" class="btn btn-secondary">Get the Certificate</a>
                </div>

                <script>
                    function showTab(tabId) {
                        // Hide all tab contents
                        document.querySelectorAll('.tab-content').forEach(content => {
                            content.classList.remove('active');
                        });
                        
                        // Show selected tab content
                        document.getElementById(tabId).classList.add('active');
                        
                        // Update tab buttons
                        document.querySelectorAll('.tab-btn').forEach(btn => {
                            btn.classList.remove('active');
                            if(btn.getAttribute('data-tab') === tabId) {
                                btn.classList.add('active');
                            }
                        });
                    }
                </script>
            </div>
            <div class="course-image" style="background-image: url('images/Phishing Awern..jpg .jpg'); background-size: cover; background-position: center;">
            </div>
        </div>
    </section>

    <!-- Course Overview -->
    <section class="course-overview">
        <div class="container">
            <div class="course-tabs">
                <button class="tab-btn active" data-tab="overview">Overview</button>
                <button class="tab-btn" data-tab="curriculum">Curriculum</button>
                <button class="tab-btn" data-tab="reviews">Reviews</button>
            </div>
            
            <div class="tab-content active" id="overview">
                <h2>Course Overview</h2>
                <p id="course-overview-text">
                    Phishing attacks remain one of the most prevalent and successful methods of cyber attack. In this comprehensive course, you will learn how to identify various types of phishing attempts, understand the psychology behind these attacks, and develop practical skills to protect yourself and your organization. Through interactive exercises and real-world examples, you'll gain the knowledge to recognize suspicious emails, links, and websites before they can cause harm. This course covers everything from basic phishing techniques to sophisticated spear phishing and whaling attacks, providing you with a complete defense toolkit against social engineering threats.
                </p>
                
                <h3>What You Will Learn</h3>
                <ul class="course-features">
                    <li>
                        <i class="fas fa-check-circle"></i>
                        <span>Identify common indicators of phishing emails and websites</span>
                    </li>
                    <li>
                        <i class="fas fa-check-circle"></i>
                        <span>Understand the psychology behind social engineering attacks</span>
                    </li>
                    <li>
                        <i class="fas fa-check-circle"></i>
                        <span>Recognize different types of phishing (spear phishing, whaling, smishing, etc.)</span>
                    </li>
                    <li>
                        <i class="fas fa-check-circle"></i>
                        <span>Implement best practices for email and web browsing security</span>
                    </li>
                    <li>
                        <i class="fas fa-check-circle"></i>
                        <span>Learn proper reporting procedures for suspected phishing attempts</span>
                    </li>
                </ul>
                
                <h3>Course Requirements</h3>
                <ul class="requirements-list">
                    <li>No prior cybersecurity knowledge required</li>
                    <li>Basic computer skills and familiarity with email</li>
                    <li>A computer with internet access</li>
                </ul>
                
                <h3>Who This Course is For</h3>
                <ul class="target-audience">
                    <li>All employees who use email or access the internet as part of their job</li>
                    <li>Team leaders who want to help protect their teams from phishing attacks</li>
                    <li>Anyone interested in improving their personal cybersecurity awareness</li>
                </ul>
            </div>
            
            <div class="tab-content" id="curriculum">
                <h2>Course Curriculum</h2>
                
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        // Listen for course updates
                        window.addEventListener('storage', function(e) {
                            if (e.key === 'cybertech_admin_courses' || e.key === 'cybertech_admin_courses_last_update') {
                                updateCourseModules();
                            }
                        });
                        
                        // Initial load
                        updateCourseModules();
                        
                        function updateCourseModules() {
                            try {
                                const adminCourses = JSON.parse(localStorage.getItem('cybertech_admin_courses') || '[]');
                                const phishingCourse = adminCourses.find(c => c.name === "Phishing Awareness");
                                
                                if (phishingCourse && phishingCourse.modules) {
                                    const curriculumContent = document.getElementById('curriculum');
                                    if (!curriculumContent) return;
                                    
                                    // Keep the title
                                    const title = curriculumContent.querySelector('h2');
                                    curriculumContent.innerHTML = '';
                                    curriculumContent.appendChild(title);
                                    
                                    // Add each module
                                    phishingCourse.modules.forEach((module, index) => {
                                        const moduleDiv = document.createElement('div');
                                        moduleDiv.className = 'course-module';
                                        
                                        // Create module header
                                        const moduleHeader = document.createElement('div');
                                        moduleHeader.className = 'module-header';
                                        moduleHeader.innerHTML = `
                                            <h3 class="module-title">Module ${index + 1}: ${module.title}</h3>
                                            <span class="module-length">
                                                <i class="fas fa-clock"></i>
                                                <span class="module-duration">${module.duration}</span>
                                            </span>
                                        `;
                                        
                                        // Create module content
                                        const moduleContent = document.createElement('div');
                                        moduleContent.className = 'module-content';
                                        
                                        // Add lessons for all modules
                                        if (module.lessons && module.lessons.length > 0) {
                                            const lessonsHTML = module.lessons.map(lesson => {
                                                // Check if this is a reading lesson
                                                const isReadingLesson = lesson.title === "Common Types of Phishing Attacks";
                                                
                                                if (isReadingLesson) {
                                                    return `
                                                        <li>
                                                            <div class="lesson-info reading-lesson" onclick="openPhishingTypesModal()">
                                                                <i class="fas fa-file-alt" style="color: #e74c3c;"></i>
                                                                <span>${lesson.title}</span>
                                                            </div>
                                                            <span class="lesson-length">${lesson.duration}</span>
                                                        </li>
                                                    `;
                                                } else {
                                                    return `
                                                        <li>
                                                            <div class="lesson-info video-lesson" id="${module.title.toLowerCase().replace(/\s+/g, '-')}-${lesson.id}-lesson" style="cursor: pointer;">
                                                                <i class="fas fa-play-circle"></i>
                                                                <span>${lesson.title}</span>
                                                            </div>
                                                            <span class="lesson-length" id="${module.title.toLowerCase().replace(/\s+/g, '-')}-${lesson.id}-duration">${lesson.duration}</span>
                                                        </li>
                                                    `;
                                                }
                                            }).join('');
                                            
                                            moduleContent.innerHTML = `
                                                <ul class="module-lessons">
                                                    ${lessonsHTML}
                                                </ul>
                                            `;
                                        }
                                        
                                        moduleDiv.appendChild(moduleHeader);
                                        moduleDiv.appendChild(moduleContent);
                                        curriculumContent.appendChild(moduleDiv);
                                    });
                                    
                                    console.log('✅ Course modules updated successfully');
                                    
                                    // Reinitialize video handlers
                                    initializeVideoHandlers();
                                } else {
                                    console.warn('Phishing course not found in admin courses');
                                }
                            } catch (error) {
                                console.error('Error updating course modules:', error);
                            }
                        }
                        
                        function initializeVideoHandlers() {
                            // Re-initialize video click handlers and other functionality
                            const videoLessons = document.querySelectorAll('.video-lesson');
                            videoLessons.forEach(lesson => {
                                if (lesson.id) {
                                    const videoHandlers = window.videoHandlers && window.videoHandlers[lesson.id];
                                    if (videoHandlers && typeof videoHandlers.initialize === 'function') {
                                        videoHandlers.initialize();
                                    }
                                }
                            });
                        }
                    });
                </script>
                
                <div class="course-module">
                    <div class="module-header">
                        <h3 class="module-title">Module 1: Introduction to Phishing</h3>
                        <span class="module-length"><i class="fas fa-clock"></i> <span class="module-duration">25 minutes</span></span>
                    </div>
                    <div class="module-content">
                        <ul class="module-lessons">
                            <li>
                                <div class="lesson-info video-lesson" onclick="openVideoModal('Phishing Shotgun', 'phishing_shotgun_video', 8)">
                                    <i class="fas fa-play-circle"></i>
                                    <span>Phishing Shotgun</span>
                                </div>
                                <span class="lesson-length">8 min</span>
                            </li>
                            </li>
                            <li>
                                <div class="lesson-info video-lesson" onclick="openVideoModal('The History of Phishing Attacks', 'phishing_history_video', 10)">
                                    <i class="fas fa-play-circle"></i>
                                    <span>The History of Phishing Attacks</span>
                                </div>
                                <span class="lesson-length">10 min</span>
                            </li>
                                        

                                        
                                        // Force refresh on page load
                                        window.addEventListener('load', function() {
                                            console.log('Page loaded, forcing video data refresh');
                                            setTimeout(function() {
                                                const refreshedVideo = getLatestVideoData();
                                                console.log('Refreshed video data:', refreshedVideo);
                                                if (refreshedVideo && refreshedVideo.videoUrl) {
                                                    // Update UI with latest data
                                                    if (durationSpan) {
                                                        durationSpan.textContent = refreshedVideo.duration + ' min';
                                                    }
                                                    lessonDiv.classList.add('admin-video');
                                                }
                                            }, 1000);
                                        });
                                        
                                        if (adminVideo && adminVideo.videoUrl) {
                                            console.log('Found admin video for history lesson:', adminVideo);
                                            
                                            // Update duration
                                            if (durationSpan) {
                                                durationSpan.textContent = adminVideo.duration + ' min';
                                            }
                                            
                                            // Add admin video class
                                            lessonDiv.classList.add('admin-video');
                                            
                                            // Set up click handler
                                            lessonDiv.onclick = function() {
                                                const modal = document.getElementById('videoModal');
                                                const video = document.getElementById('courseVideo');
                                                const videoTitle = document.getElementById('videoTitle');
                                                const durationText = document.getElementById('durationText');
                                                
                                                // Clear any existing video data
                                                localStorage.removeItem('video_data_phishing_history_video');
                                                localStorage.removeItem('phishing_history_video_cache');
                                                
                                                // Force browser to forget the video source
                                                video.src = '';
                                                video.removeAttribute('src');
                                                video.load();
                                                
                                                // Force refresh to get the latest video data
                                                const latestVideo = getLatestVideoData(true);
                                                console.log('Latest video data on click (forced refresh):', latestVideo);
                                                
                                                // Reset video completely
                                                video.pause();
                                                video.removeAttribute('src');
                                                video.load();
                                                
                                                // Show modal first
                                                modal.style.display = 'block';
                                                
                                                // Set video properties for better display
                                                video.style.display = 'block';
                                                video.style.width = '100%';
                                                video.style.height = '400px';
                                                video.style.backgroundColor = '#000';
                                                video.style.objectFit = 'contain';
                                                video.style.opacity = '1';
                                                video.style.visibility = 'visible';
                                                
                                                try {
                                                    console.log('Loading admin video for History and Evolution lesson');
                                                    
                                                    // Use the latest video data instead of the initial one
                                                    const videoToUse = latestVideo || adminVideo;
                                                    
                                                    if (!videoToUse || !videoToUse.videoUrl) {
                                                        throw new Error('No valid video data found');
                                                    }
                                                    
                                                    // Handle base64 encoded videos
                                                    if (videoToUse.videoUrl.startsWith('data:')) {
                                                        const base64Data = videoToUse.videoUrl;
                                                        const byteCharacters = atob(base64Data.split(',')[1] || base64Data);
                                                        const byteArrays = [];
                                                        
                                                        for (let offset = 0; offset < byteCharacters.length; offset += 512) {
                                                            const slice = byteCharacters.slice(offset, offset + 512);
                                                            const byteNumbers = new Array(slice.length);
                                                            for (let i = 0; i < slice.length; i++) {
                                                                byteNumbers[i] = slice.charCodeAt(i);
                                                            }
                                                            const byteArray = new Uint8Array(byteNumbers);
                                                            byteArrays.push(byteArray);
                                                        }
                                                        
                                                        const blob = new Blob(byteArrays, { type: 'video/mp4' });
                                                        const blobUrl = URL.createObjectURL(blob);
                                                        
                                                        // Set video source to blob URL
                                                        video.src = blobUrl;
                                                        
                                                        // Clean up old blob URL when video ends
                                                        video.onended = function() {
                                                            URL.revokeObjectURL(blobUrl);
                                                        };
                                                    } else {
                                                        // Direct URL
                                                        video.src = videoToUse.videoUrl;
                                                    }
                                                    
                                                    videoTitle.textContent = videoToUse.title || 'The History and Evolution of Phishing Attacks';
                                                    durationText.textContent = videoToUse.duration + ' min';
                                                    
                                                    // Force reload
                                                    video.load();
                                                    
                                                    // Play when ready
                                                    video.oncanplay = function() {
                                                        video.play().catch(function(error) {
                                                            console.error('Error playing video:', error);
                                                        });
                                                    };
                                                    
                                                } catch(error) {
                                                    console.error('Error loading video:', error);
                                                    
                                                    // Try to get fresh video data
                                                    const freshVideo = getLatestVideoData();
                                                    
                                                    if (freshVideo && freshVideo.videoUrl) {
                                                        console.log('Retrying with fresh video data');
                                                        try {
                                                            if (freshVideo.videoUrl.startsWith('data:')) {
                                                                const base64Data = freshVideo.videoUrl;
                                                                const byteCharacters = atob(base64Data.split(',')[1] || base64Data);
                                                                const byteArrays = [];
                                                                
                                                                for (let offset = 0; offset < byteCharacters.length; offset += 512) {
                                                                    const slice = byteCharacters.slice(offset, offset + 512);
                                                                    const byteNumbers = new Array(slice.length);
                                                                    for (let i = 0; i < slice.length; i++) {
                                                                        byteNumbers[i] = slice.charCodeAt(i);
                                                                    }
                                                                    const byteArray = new Uint8Array(byteNumbers);
                                                                    byteArrays.push(byteArray);
                                                                }
                                                                
                                                                const blob = new Blob(byteArrays, { type: 'video/mp4' });
                                                                const blobUrl = URL.createObjectURL(blob);
                                                                
                                                                video.src = blobUrl;
                                                                
                                                                video.onended = function() {
                                                                    URL.revokeObjectURL(blobUrl);
                                                                };
                                                            } else {
                                                                video.src = freshVideo.videoUrl;
                                                            }
                                                            
                                                            videoTitle.textContent = freshVideo.title || 'The History and Evolution of Phishing Attacks';
                                                            durationText.textContent = freshVideo.duration + ' min';
                                                            
                                                            video.load();
                                                            video.play().catch(function(error) {
                                                                console.error('Error playing fresh video:', error);
                                                            });
                                                            return;
                                                        } catch (retryError) {
                                                            console.error('Error retrying with fresh video:', retryError);
                                                        }
                                                    }
                                                    
                                                    // Only fallback to default video if no admin video is available
                                                    const adminVideos = JSON.parse(localStorage.getItem('cybertech_admin_videos') || '[]');
                                                    const hasAdminVideo = adminVideos.some(v => 
                                                        (v.courseName === 'Phishing Awareness' || v.course === 'Phishing Awareness') &&
                                                        (v.moduleName === 'Introduction to Phishing' || v.module === 'Introduction to Phishing') &&
                                                        (v.lessonName === 'The History and Evolution of Phishing Attacks' || 
                                                         v.lesson === 'The History and Evolution of Phishing Attacks')
                                                    );
                                                    
                                                    if (!hasAdminVideo) {
                                                        console.log('No admin video available, using default video');
                                                        video.src = 'videos/courses/Phishing 1.mp4';
                                                        videoTitle.textContent = 'The History and Evolution of Phishing Attacks';
                                                        durationText.textContent = '10 min';
                                                        
                                                        video.load();
                                                        video.play().catch(function(error) {
                                                            console.error('Error playing fallback video:', error);
                                                        });
                                                    } else {
                                                        console.error('Admin video exists but failed to load');
                                                        video.style.display = 'none';
                                                        const errorMessage = document.createElement('div');
                                                        errorMessage.style.padding = '20px';
                                                        errorMessage.style.textAlign = 'center';
                                                        errorMessage.innerHTML = `
                                                            <p style="color: red;">Error loading video. Please try refreshing the page.</p>
                                                            <button onclick="location.reload()" style="padding: 10px 20px; margin-top: 10px;">Refresh Page</button>
                                                        `;
                                                        video.parentElement.appendChild(errorMessage);
                                                    }
                                                }
                                            };
                                        }
                                        
                                        // Listen for video updates
                                        window.addEventListener('newVideoAdded', function(event) {
                                            const newVideo = event.detail.video;
                                            if (newVideo.courseName === 'Phishing Awareness' &&
                                                newVideo.moduleName === 'Introduction to Phishing' &&
                                                newVideo.lessonName === 'The History and Evolution of Phishing Attacks') {
                                                
                                                console.log('New video added for History and Evolution lesson:', newVideo);
                                                
                                                // Force refresh video data
                                                updateHistoryLesson();
                                                
                                                // Update duration
                                                if (durationSpan) {
                                                    durationSpan.textContent = newVideo.duration + ' min';
                                                }
                                                
                                                // Add admin video class
                                                lessonDiv.classList.add('admin-video');
                                                
                                                // Update click handler with new video
                                                lessonDiv.onclick = function() {
                                                    const modal = document.getElementById('videoModal');
                                                    const video = document.getElementById('courseVideo');
                                                    const videoTitle = document.getElementById('videoTitle');
                                                    const durationText = document.getElementById('durationText');
                                                    
                                                    // Reset video completely
                                                    video.pause();
                                                    video.removeAttribute('src');
                                                    video.load();
                                                    
                                                    // Show modal first
                                                    modal.style.display = 'block';
                                                    
                                                    // Set video properties for better display
                                                    video.style.display = 'block';
                                                    video.style.width = '100%';
                                                    video.style.height = '400px';
                                                    video.style.backgroundColor = '#000';
                                                    video.style.objectFit = 'contain';
                                                    video.style.opacity = '1';
                                                    video.style.visibility = 'visible';
                                                    
                                                    try {
                                                        console.log('Loading newly added video for History and Evolution lesson');
                                                        
                                                        // Handle base64 encoded videos
                                                        if (newVideo.videoUrl.startsWith('data:')) {
                                                            const base64Data = newVideo.videoUrl;
                                                            const byteCharacters = atob(base64Data.split(',')[1] || base64Data);
                                                            const byteArrays = [];
                                                            
                                                            for (let offset = 0; offset < byteCharacters.length; offset += 512) {
                                                                const slice = byteCharacters.slice(offset, offset + 512);
                                                                const byteNumbers = new Array(slice.length);
                                                                for (let i = 0; i < slice.length; i++) {
                                                                    byteNumbers[i] = slice.charCodeAt(i);
                                                                }
                                                                const byteArray = new Uint8Array(byteNumbers);
                                                                byteArrays.push(byteArray);
                                                            }
                                                            
                                                            const blob = new Blob(byteArrays, { type: 'video/mp4' });
                                                            const blobUrl = URL.createObjectURL(blob);
                                                            
                                                            // Set video source to blob URL
                                                            video.src = blobUrl;
                                                            
                                                            // Clean up old blob URL when video ends
                                                            video.onended = function() {
                                                                URL.revokeObjectURL(blobUrl);
                                                            };
                                                        } else {
                                                            // Direct URL
                                                            video.src = newVideo.videoUrl;
                                                        }
                                                        
                                                        videoTitle.textContent = newVideo.title || 'The History and Evolution of Phishing Attacks';
                                                        durationText.textContent = newVideo.duration + ' min';
                                                        
                                                        // Force reload
                                                        video.load();
                                                        
                                                        // Play when ready
                                                        video.oncanplay = function() {
                                                            video.play().catch(function(error) {
                                                                console.error('Error playing video:', error);
                                                            });
                                                        };
                                                        
                                                    } catch(error) {
                                                        console.error('Error loading video:', error);
                                                        
                                                        // Fallback to default video if available
                                                        video.src = 'videos/courses/Phishing 1.mp4';
                                                        videoTitle.textContent = 'The History and Evolution of Phishing Attacks';
                                                        durationText.textContent = '10 min';
                                                        
                                                        // Force reload
                                                        video.load();
                                                        
                                                        // Play when ready
                                                        video.oncanplay = function() {
                                                            video.play().catch(function(error) {
                                                                console.error('Error playing fallback video:', error);
                                                            });
                                                };
                                            }
                            </li>
                            <li>
                                <div class="lesson-info reading-lesson" onclick="openPhishingTypesModal()">
                                    <i class="fas fa-file-alt" style="color: #e74c3c;"></i>
                                    <span>Common Types of Phishing Attacks</span>
                                </div>
                                <span class="lesson-length">7 min</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="course-module">
                    <div class="module-header">
                        <h3 class="module-title">Module 2: Identifying Phishing Attempts</h3>
                        <span class="module-length"><i class="fas fa-clock"></i> <span class="module-duration">22 minutes</span></span>
                    </div>
                    <div class="module-content">
                        <ul class="module-lessons">
                            <li>
                                <div class="lesson-info video-lesson" onclick="openVideoModal('Red Flags', 'red_flags_video', 12)">
                                    <i class="fas fa-play-circle"></i>
                                    <span>Red Flags</span>
                                </div>
                                <span class="lesson-length">12 min</span>
                            </li>
                            <li>
                                <div class="lesson-info video-lesson" onclick="openVideoModal('Analyzing URLs and Website Security', 'url_analysis_video', 10)">
                                    <i class="fas fa-play-circle"></i>
                                    <span>Analyzing URLs and Website Security</span>
                                </div>
                                <span class="lesson-length">10 min</span>
                            </li>
                                            console.log('Opening Spot the Phish exercise with course styling...');
                                            
                                            // Create modal that matches the course page design
                                            let modal = document.getElementById('spot-phish-quiz-modal');
                                            if (!modal) {
                                                modal = document.createElement('div');
                                                modal.id = 'spot-phish-quiz-modal';
                                                modal.className = 'video-modal';
                                                modal.style.cssText = `
                                                    display: none;
                                                    position: fixed;
                                                    z-index: 1000;
                                                    left: 0;
                                                    top: 0;
                                                    width: 100%;
                                                    height: 100%;
                                                    background-color: rgba(0, 0, 0, 0.8);
                                                `;
                                                
                                                const modalContent = `
                                                    <div class="video-modal-content" style="background-color: #fefefe; margin: 5% auto; padding: 20px; width: 90%; max-width: 800px; border-radius: 8px; position: relative;">
                                                        <div class="video-modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                                            <h3 style="color: #333; margin: 0; font-family: 'Poppins', sans-serif; font-weight: 600;">Spot the Phish Interactive Exercise</h3>
                                                            <button onclick="closeSpotPhishQuiz()" style="background: none; border: none; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa;">&times;</button>
                                                        </div>
                                                        
                                                        <div class="video-modal-body">
                                                            <div id="quiz-intro" style="display: block; text-align: center; padding: 20px;">
                                                                <div style="margin-bottom: 30px;">
                                                                    <i class="fas fa-puzzle-piece" style="font-size: 48px; color: #4e54c8; margin-bottom: 20px;"></i>
                                                                    <h2 style="color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; margin-bottom: 15px;">Test Your Phishing Detection Skills</h2>
                                                                    <p style="font-size: 16px; color: #666; line-height: 1.6; margin-bottom: 20px;">You'll be shown 5 different email scenarios. Your task is to identify which ones are legitimate and which ones are phishing attempts.</p>
                                                                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                                                                        <h4 style="color: #4e54c8; margin-bottom: 15px;">Look for these red flags:</h4>
                                                                        <ul style="text-align: left; color: #666; line-height: 1.8;">
                                                                            <li>Suspicious sender addresses</li>
                                                                            <li>Urgent language or threats</li>
                                                                            <li>Poor grammar and spelling</li>
                                                                            <li>Suspicious links or attachments</li>
                                                                            <li>Requests for personal information</li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                                <button onclick="startSpotPhishQuiz()" class="btn btn-primary" style="background-color: #4e54c8; color: white; font-size: 18px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 0 20px rgba(78, 84, 200, 0.6);">Start Exercise</button>
                                                            </div>
                                                            
                                                            <div id="quiz-container" style="display: none;">
                                                                <div id="question-container" style="margin-bottom: 30px;">
                                                                    <!-- Questions will be inserted here -->
                                                                </div>
                                                                
                                                                                                <div id="quiz-controls" style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                                    <span id="question-counter" style="font-size: 16px; color: #666; font-weight: 500;">Email 1 of 5</span>
                                    <button id="next-question-btn" onclick="nextQuestion()" class="btn btn-primary" style="background-color: #4e54c8; color: white; font-size: 16px; padding: 12px 25px; border-radius: 30px; border: none; cursor: pointer; margin-left: 15px; display: none;">Next Email</button>
                                </div>
                                                            </div>
                                                            
                                                            <div id="quiz-results" style="display: none; text-align: center; padding: 30px;">
                                                                <div style="margin-bottom: 30px;">
                                                                    <i class="fas fa-trophy" style="font-size: 48px; color: #00c9a7; margin-bottom: 20px;"></i>
                                                                    <h2 style="color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; margin-bottom: 15px;">Exercise Complete!</h2>
                                                                </div>
                                                                
                                                                <div id="score-display" style="margin-bottom: 30px;">
                                                                    <div style="font-size: 48px; color: #4e54c8; margin: 20px 0; font-weight: 700;">
                                                                        <span id="final-score">0</span>/5
                                                                    </div>
                                                                    <p id="score-message" style="font-size: 18px; color: #666; line-height: 1.6; margin-bottom: 20px;">Score message will appear here</p>
                                                                </div>
                                                                
                                                                <button onclick="closeSpotPhishQuiz()" class="btn btn-primary" style="background-color: #00c9a7; color: white; font-size: 18px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 0 20px rgba(0, 201, 167, 0.6);">Close Exercise</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                `;
                                                
                                                modal.innerHTML = modalContent;
                                                document.body.appendChild(modal);
                                            }
                                            
                                            modal.style.display = 'block';
                                        };
                                    }
                                });
                            });
                                        
                                        // Sample phishing emails for the exercise
                                        const phishingEmails = [
                                            {
                                                sender: "Amazon Customer Service <amazon-support@amazn-services.com>",
                                                subject: "Urgent: Your Amazon Account Has Been Suspended",
                                                body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif;">
                                                    <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                                                        <div><strong>From:</strong> Amazon Customer Service &lt;amazon-support@amazn-services.com&gt;</div>
                                                        <div><strong>Subject:</strong> Urgent: Your Amazon Account Has Been Suspended</div>
                                                        <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                                                    </div>
                                                    <div style="padding: 10px 0;">
                                                        <p>Dear Valued Customer,</p>
                                                        <p>We regret to inform you that your Amazon account has been temporarily suspended due to failed verification of your billing information.</p>
                                                        <p>To restore your account access, please verify your information by clicking the link below:</p>
                                                        <p><a href="#" style="color: blue; text-decoration: underline;">https://amazn-account-verify.com/restore-account</a></p>
                                                        <p>If you do not verify your account within 24 hours, your account will be permanently deactivated.</p>
                                                        <p>Thank you for your cooperation.</p>
                                                        <p>Amazon Customer Service Team</p>
                                                    </div>
                                                </div>`,
                                                isPhishing: true,
                                                redFlags: [
                                                    "Misspelled domain in email address (amazn-services.com instead of amazon.com)",
                                                    "Creates urgency with threats of account suspension",
                                                    "Suspicious link URL (amazn-account-verify.com is not an Amazon domain)",
                                                    "Generic greeting ('Valued Customer' instead of your name)"
                                                ]
                                            },
                                            {
                                                sender: "Microsoft Security Team <security@microsoft.com>",
                                                subject: "Your Microsoft Account: Action Required",
                                                body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif;">
                                                    <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                                                        <div><strong>From:</strong> Microsoft Security Team &lt;security@microsoft.com&gt;</div>
                                                        <div><strong>Subject:</strong> Your Microsoft Account: Action Required</div>
                                                        <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                                                    </div>
                                                    <div style="padding: 10px 0;">
                                                        <p>Hello,</p>
                                                        <p>We detected unusual sign-in activity on your Microsoft account. To secure your account, we've temporarily limited access.</p>
                                                        <p>Please verify your identity by confirming your account details at:</p>
                                                        <p><a href="#" style="color: blue; text-decoration: underline;">https://security-microsoft-verify.net/account</a></p>
                                                        <p>This link will expire in 24 hours.</p>
                                                        <p>Microsoft Security</p>
                                                    </div>
                                                </div>`,
                                                isPhishing: true,
                                                redFlags: [
                                                    "Suspicious link URL (security-microsoft-verify.net is not a Microsoft domain)",
                                                    "Creates urgency with 'unusual activity' claim",
                                                    "Generic greeting with no personalization",
                                                    "Vague about the specific unusual activity"
                                                ]
                                            },
                                            {
                                                sender: "PayPal <service@paypal.com>",
                                                subject: "Your account has been limited until we hear from you",
                                                body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif;">
                                                    <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                                                        <div><strong>From:</strong> PayPal &lt;service@paypal.com&gt;</div>
                                                        <div><strong>Subject:</strong> Your account has been limited until we hear from you</div>
                                                        <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                                                    </div>
                                                    <div style="padding: 10px 0;">
                                                        <img src="https://www.paypalobjects.com/webstatic/i/logo/rebrand/ppcom.svg" alt="PayPal Logo" style="height: 40px; margin-bottom: 15px;">
                                                        <p>We noticed some unusual activity in your account. To ensure your account safety, we've temporarily limited some features.</p>
                                                        <p>Please log in to your PayPal account to verify your information:</p>
                                                        <p style="text-align: center;">
                                                            <a href="https://www.paypal.com/signin" style="background-color: #0070ba; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">Log In to PayPal</a>
                                                        </p>
                                                        <p>If you don't recognize this activity, please secure your account by changing your password after logging in.</p>
                                                        <p>Thank you for your prompt attention to this matter.</p>
                                                        <p>PayPal Customer Service</p>
                                                    </div>
                                                </div>`,
                                                isPhishing: false,
                                                legitimateFeatures: [
                                                    "Correct sender domain (paypal.com)",
                                                    "Link goes to the actual PayPal website",
                                                    "No request for personal information via email",
                                                    "Professional design with proper branding",
                                                    "No spelling or grammar errors"
                                                ]
                                            },
                                            {
                                                sender: "Netflix <info@mailer.netflix.com>",
                                                subject: "Your Netflix payment didn't go through",
                                                body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif;">
                                                    <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                                                        <div><strong>From:</strong> Netflix &lt;info@mailer.netflix.com&gt;</div>
                                                        <div><strong>Subject:</strong> Your Netflix payment didn't go through</div>
                                                        <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                                                    </div>
                                                    <div style="padding: 10px 0;">
                                                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png" alt="Netflix Logo" style="height: 40px; margin-bottom: 15px;">
                                                        <p>Hi there,</p>
                                                        <p>We're having some trouble with your current billing information. We'll try again, but to avoid any interruption of your service, please update your payment details.</p>
                                                        <p style="text-align: center;">
                                                            <a href="https://www.netflix.com/YourAccount" style="background-color: #e50914; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">Update Payment Information</a>
                                                        </p>
                                                        <p>If you need help, visit the <a href="https://help.netflix.com/">Netflix Help Center</a>.</p>
                                                        <p>–Your friends at Netflix</p>
                                                    </div>
                                                </div>`,
                                                isPhishing: false,
                                                legitimateFeatures: [
                                                    "Correct sender domain (mailer.netflix.com is a legitimate Netflix email domain)",
                                                    "Link goes to the actual Netflix website",
                                                    "Professional design with proper branding",
                                                    "No urgent threats or extreme consequences mentioned",
                                                    "Provides alternative help options"
                                                ]
                                            },
                                            {
                                                sender: "Bank of America <secure@bankofamerica.com>",
                                                subject: "URGENT: Unauthorized Access Detected",
                                                body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif;">
                                                    <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                                                        <div><strong>From:</strong> Bank of America &lt;secure@bankofamerica.com&gt;</div>
                                                        <div><strong>Subject:</strong> URGENT: Unauthorized Access Detected</div>
                                                        <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                                                    </div>
                                                    <div style="padding: 10px 0;">
                                                        <img src="https://1000logos.net/wp-content/uploads/2016/10/Bank-of-America-Logo.png" alt="Bank of America Logo" style="height: 40px; margin-bottom: 15px;">
                                                        <p>Dear Valued Customer,</p>
                                                        <p>Our security system has detected unauthorized access attempts to your online banking account. For your protection, we have temporarily restricted access to your account.</p>
                                                        <p>To restore access immediately, please verify your identity by clicking the link below and confirming your account details:</p>
                                                        <p><a href="#" style="color: blue; text-decoration: underline;">https://secure-bankofamerica.com-verify.us/login</a></p>
                                                        <p>If you do not verify your account within 24 hours, your account will be suspended.</p>
                                                        <p>Thank you for your cooperation.</p>
                                                        <p>Bank of America Security Team</p>
                                                    </div>
                                                </div>`,
                                                isPhishing: true,
                                                redFlags: [
                                                    "Suspicious URL (secure-bankofamerica.com-verify.us is not a Bank of America domain)",
                                                    "Creates urgency with 'URGENT' in the subject and threats of account suspension",
                                                    "Generic greeting ('Valued Customer')",
                                                    "Requests verification of account details via a link",
                                                    "Threatening tone with time pressure (24 hours)"
                                                ]
                                            }
                                        ];
                                        
                                        let currentEmailIndex = 0;
                                        let score = 0;
                                        
                                        // Function to start the Spot the Phish exercise
                                        function startSpotPhishExercise() {
                                            // Reset exercise state
                                            currentEmailIndex = 0;
                                            score = 0;
                                            
                                            // Shuffle the emails
                                            shuffleArray(phishingEmails);
                                            
                                            // Show the first email
                                            showEmail(currentEmailIndex);
                                            
                                            // Set up decision buttons
                                            document.getElementById('legitimate-btn').onclick = function() {
                                                checkAnswer(false);
                                            };
                                            
                                            document.getElementById('phishing-btn').onclick = function() {
                                                checkAnswer(true);
                                            };
                                            
                                            // Set up next button
                                            document.getElementById('next-email-btn').onclick = function() {
                                                currentEmailIndex++;
                                                if (currentEmailIndex < phishingEmails.length) {
                                                    showEmail(currentEmailIndex);
                                                    document.getElementById('feedback-container').style.display = 'none';
                                                    document.getElementById('legitimate-btn').disabled = false;
                                                    document.getElementById('phishing-btn').disabled = false;
                                                } else {
                                                    showResults();
                                                }
                                            };
                                        }
                                        
                                        // Function to show an email
                                        function showEmail(index) {
                                            const emailContainer = document.getElementById('email-container');
                                            const email = phishingEmails[index];
                                            
                                            emailContainer.innerHTML = email.body;
                                            document.getElementById('email-counter').textContent = `Email ${index + 1} of ${phishingEmails.length}`;
                                        }
                                        
                                        // Function to check the answer
                                        function checkAnswer(isPhishingGuess) {
                                            const email = phishingEmails[currentEmailIndex];
                                            const isCorrect = (email.isPhishing === isPhishingGuess);
                                            
                                            if (isCorrect) {
                                                score++;
                                            }
                                            
                                            // Disable buttons
                                            document.getElementById('legitimate-btn').disabled = true;
                                            document.getElementById('phishing-btn').disabled = true;
                                            
                                            // Show feedback
                                            const feedbackContainer = document.getElementById('feedback-container');
                                            const feedbackAlert = document.getElementById('feedback-alert');
                                            
                                            feedbackAlert.className = isCorrect ? 'alert alert-success' : 'alert alert-danger';
                                            
                                            let feedbackHTML = '';
                                            if (isCorrect) {
                                                feedbackHTML = '<strong>Correct!</strong> ';
                                            } else {
                                                feedbackHTML = '<strong>Incorrect.</strong> ';
                                            }
                                            
                                            if (email.isPhishing) {
                                                feedbackHTML += 'This is a phishing email.<br><br><strong>Red Flags:</strong><ul>';
                                                email.redFlags.forEach(flag => {
                                                    feedbackHTML += `<li>${flag}</li>`;
                                                });
                                                feedbackHTML += '</ul>';
                                            } else {
                                                feedbackHTML += 'This is a legitimate email.<br><br><strong>Legitimate Features:</strong><ul>';
                                                email.legitimateFeatures.forEach(feature => {
                                                    feedbackHTML += `<li>${feature}</li>`;
                                                });
                                                feedbackHTML += '</ul>';
                                            }
                                            
                                            feedbackAlert.innerHTML = feedbackHTML;
                                            feedbackContainer.style.display = 'block';
                                        }
                                        
                                        // Function to show results
                                        function showResults() {
                                            document.getElementById('spot-phish-container').style.display = 'none';
                                            document.getElementById('spot-phish-results').style.display = 'block';
                                            
                                            const scoreValue = document.getElementById('phish-score-value');
                                            scoreValue.textContent = score;
                                            
                                            const phishFeedback = document.getElementById('phish-feedback');
                                            
                                            if (score === phishingEmails.length) {
                                                phishFeedback.innerHTML = `
                                                    <h4>Perfect Score!</h4>
                                                    <p>Excellent work! You correctly identified all emails. You have a strong ability to spot phishing attempts.</p>
                                                `;
                                            } else if (score >= Math.floor(phishingEmails.length * 0.7)) {
                                                phishFeedback.innerHTML = `
                                                    <h4>Good Job!</h4>
                                                    <p>You did well! You have a good eye for identifying phishing attempts, but there's still room for improvement.</p>
                                                `;
                                            } else {
                                                phishFeedback.innerHTML = `
                                                    <h4>Keep Practicing</h4>
                                                    <p>You missed several phishing emails. Review the red flags and try again to improve your phishing detection skills.</p>
                                                `;
                                            }
                                            
                                            // Save exercise result for admin dashboard
                                            saveExerciseResult('Phishing Awareness', score, phishingEmails.length);
                                        }
                                        
                                        // Function to save exercise results
                                        function saveExerciseResult(exerciseName, score, totalQuestions) {
                                            // Get logged-in user information
                                            const currentUser = JSON.parse(localStorage.getItem('cybertech_user') || '{}');
                                            let userName = currentUser.username || currentUser.name;
                                            let userEmail = currentUser.email;
                                            let userId = currentUser.id || currentUser.username;
                                            
                                            // If user is not logged in, prompt for name
                                            if (!userName) {
                                                userName = prompt('Please enter your name to save your result:') || 'Anonymous User';
                                                userEmail = prompt('Please enter your email (optional):') || 'No email provided';
                                                userId = userName; // Use name as ID for anonymous users
                                            }
                                            
                                            console.log('User data for exercise result:', { currentUser, userName, userEmail, userId });
                                            console.log('localStorage cybertech_user:', localStorage.getItem('cybertech_user'));
                                            console.log('localStorage cybertech_admin_users:', localStorage.getItem('cybertech_admin_users'));
                                            
                                            const percentage = Math.round((score / totalQuestions) * 100);
                                            
                                            // Create exercise result
                                            const exerciseResult = {
                                                name: userName,
                                                email: userEmail,
                                                userId: userId,
                                                score: percentage,
                                                dateTaken: new Date().toISOString().split('T')[0],
                                                category: 'Phishing Awareness',
                                                status: percentage >= 50 ? 'passed' : 'failed',
                                                exerciseName: exerciseName
                                            };
                                            
                                            // Get existing results or initialize empty array
                                            const existingResults = JSON.parse(localStorage.getItem('cybertech_assessment_results') || '[]');
                                            existingResults.push(exerciseResult);
                                            localStorage.setItem('cybertech_assessment_results', JSON.stringify(existingResults));
                                            
                                            console.log('Exercise result saved:', exerciseResult);
                                            
                                            // Show success message
                                            const quizResults = document.getElementById('quiz-results');
                                            if (quizResults) {
                                                quizResults.innerHTML = `
                                                    <div style="margin-bottom: 30px;">
                                                        <i class="fas fa-check-circle" style="font-size: 48px; color: #28a745; margin-bottom: 20px;"></i>
                                                        <h2 style="color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; margin-bottom: 15px;">Result Saved!</h2>
                                                    </div>
                                                    
                                                    <div id="score-display" style="margin-bottom: 30px;">
                                                        <div style="font-size: 48px; color: #4e54c8; margin: 20px 0; font-weight: 700;">
                                                            ${score}/${totalQuestions}
                                                        </div>
                                                        <p id="score-message" style="font-size: 18px; color: #666; line-height: 1.6; margin-bottom: 20px;">
                                                            ${percentage >= 80 ? 'Excellent! You have excellent phishing detection skills! 🎉' : 
                                                              percentage >= 60 ? 'Good job! You have good phishing detection skills! 👍' : 
                                                              percentage >= 40 ? 'Not bad! Keep practicing to improve your skills! 💪' : 
                                                              'Keep learning! Practice will help you improve! 📚'}
                                                        </p>
                                                        <p style="color: #28a745; font-weight: 600; font-size: 16px;">✅ Your result has been saved and sent to admin dashboard.</p>
                                                    </div>
                                                    
                                                    <button onclick="closeSpotPhishQuiz()" class="btn btn-primary" style="background-color: #00c9a7; color: white; font-size: 18px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 0 20px rgba(0, 201, 167, 0.6);">Close Exercise</button>
                                                `;
                                            }
                                        }
                                        
                                        // Utility function to shuffle an array
                                        function shuffleArray(array) {
                                            for (let i = array.length - 1; i > 0; i--) {
                                                const j = Math.floor(Math.random() * (i + 1));
                                                [array[i], array[j]] = [array[j], array[i]];
                                            }
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="course-module">
                    <div class="module-header">
                        <h3 class="module-title">Module 3: Psychology of Social Engineering</h3>
                        <span class="module-length"><i class="fas fa-clock"></i> <span class="module-duration">20 minutes</span></span>
                    </div>
                    <div class="module-content">
                                                <ul class="module-lessons">
                            <li>
                                <div class="lesson-info video-lesson" onclick="openVideoModal('Psychology behind Phishing Attacks', 'psychology_phishing_video', 15)">
                                    <i class="fas fa-play-circle"></i>
                                    <span>Psychology behind Phishing Attacks</span>
                                </div>
                                <span class="lesson-length">15 min</span>
                            </li>

                            <li>
                                <div class="lesson-info" id="spot-the-phish-exercise" style="cursor: pointer;">
                                    <i class="fas fa-puzzle-piece"></i>
                                    <span>Interactive Exercise: Spot the Phish</span>
                                </div>
                                <span class="lesson-length">5 min</span>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        const spotThePhishExercise = document.getElementById('spot-the-phish-exercise');
                                        
                                        if (spotThePhishExercise) {
                                            spotThePhishExercise.addEventListener('click', function() {
                                                openSpotThePhishExercise();
                                            });
                                        }
                                        
                                        function openSpotThePhishExercise() {
                                            // 5 phishing scenarios for the exercise
                                            const scenarios = [
                                                {
                                                    scenario: 'An email from "PayPal Security" asking you to verify your account by clicking a link',
                                                    isPhishing: true,
                                                    reason: 'Legitimate companies never ask for account verification via email links'
                                                },
                                                {
                                                    scenario: 'A text message from your bank with a secure link to check your balance',
                                                    isPhishing: false,
                                                    reason: 'This could be legitimate if you have SMS banking enabled'
                                                },
                                                {
                                                    scenario: 'An email from "Microsoft Support" claiming your computer has a virus and needs immediate attention',
                                                    isPhishing: true,
                                                    reason: 'Microsoft never sends unsolicited virus warnings via email'
                                                },
                                                {
                                                    scenario: 'A colleague asking you to review a document they shared via Google Drive',
                                                    isPhishing: false,
                                                    reason: 'This is a normal workplace request'
                                                },
                                                {
                                                    scenario: 'An email offering you a free gift card if you complete a survey',
                                                    isPhishing: true,
                                                    reason: 'Free gift card offers are almost always phishing attempts'
                                                }
                                            ];
                                            
                                            let score = 0;
                                            let totalQuestions = scenarios.length;
                                            
                                            scenarios.forEach((scenario, index) => {
                                                const userGuess = confirm(`Is this a phishing attempt?\n\nScenario ${index + 1}: ${scenario.scenario}\n\nClick OK for Phishing, Cancel for Legitimate`);
                                                
                                                if (userGuess === scenario.isPhishing) {
                                                    score++;
                                                }
                                            });
                                            
                                            const percentage = Math.round((score / totalQuestions) * 100);
                                            
                                            // Get logged-in user information
                                            const currentUser = JSON.parse(localStorage.getItem('cybertech_user') || '{}');
                                            const userName = currentUser.username || currentUser.name || 'Anonymous User';
                                            const userEmail = currentUser.email || 'No email provided';
                                            const userId = currentUser.id || currentUser.username || 'unknown';
                                            
                                            // Save result
                                            const exerciseResult = {
                                                name: userName,
                                                email: userEmail,
                                                userId: userId,
                                                score: percentage,
                                                dateTaken: new Date().toISOString().split('T')[0],
                                                category: 'Phishing Awareness',
                                                status: percentage >= 60 ? 'passed' : 'failed',
                                                exerciseName: 'Spot the Phish Exercise'
                                            };
                                            
                                            const existingResults = JSON.parse(localStorage.getItem('cybertech_assessment_results') || '[]');
                                            existingResults.push(exerciseResult);
                                            localStorage.setItem('cybertech_assessment_results', JSON.stringify(existingResults));
                                            
                                            console.log('Spot the Phish exercise result saved:', exerciseResult);
                                            
                                            alert(`Exercise Complete!\n\nScore: ${score}/${totalQuestions} (${percentage}%)\nStatus: ${percentage >= 60 ? 'Passed' : 'Failed'}\n\nResult saved to admin dashboard.`);
                                        }
                                    });
                                </script>
                            </li>
                        </ul>
                    </div>
                </div>
                

            </div>
            

            
            <div class="tab-content" id="reviews">
                <h2>Student Reviews</h2>
                
                <!-- Review Form -->
                <div class="review-form-container" id="reviewFormContainer">
                    <h3>Rate This Course</h3>
                    <p>Share your experience with CyberTech</p>
                    
                    <form id="reviewForm" class="review-form">
                        <div class="rating-input">
                            <p>Your Rating:</p>
                            <div class="star-rating">
                                <i class="far fa-star" data-rating="1"></i>
                                <i class="far fa-star" data-rating="2"></i>
                                <i class="far fa-star" data-rating="3"></i>
                                <i class="far fa-star" data-rating="4"></i>
                                <i class="far fa-star" data-rating="5"></i>
                                <input type="hidden" name="rating" id="selectedRating" value="0">
                            </div>
                        </div>
                        
                        <div class="comment-input">
                            <label for="reviewComment">Your Comment (Optional):</label>
                            <textarea id="reviewComment" name="comment" rows="4" placeholder="Share your thoughts about this course..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Submit Review</button>
                    </form>
                </div>
                
                <div class="review-summary">
                    <div class="review-average">
                        <span class="rating">4.8</span>
                        <div class="stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                        </div>
                        <span class="total-reviews">235 reviews</span>
                    </div>
                    <div class="rating-bars">
                        <div class="rating-bar">
                            <span class="rating-label">5 stars</span>
                            <div class="progress-bar">
                                <div class="progress" style="width: 80%;"></div>
                            </div>
                            <span class="rating-percent">80%</span>
                        </div>
                        <div class="rating-bar">
                            <span class="rating-label">4 stars</span>
                            <div class="progress-bar">
                                <div class="progress" style="width: 15%;"></div>
                            </div>
                            <span class="rating-percent">15%</span>
                        </div>
                        <div class="rating-bar">
                            <span class="rating-label">3 stars</span>
                            <div class="progress-bar">
                                <div class="progress" style="width: 3%;"></div>
                            </div>
                            <span class="rating-percent">3%</span>
                        </div>
                        <div class="rating-bar">
                            <span class="rating-label">2 stars</span>
                            <div class="progress-bar">
                                <div class="progress" style="width: 1%;"></div>
                            </div>
                            <span class="rating-percent">1%</span>
                        </div>
                        <div class="rating-bar">
                            <span class="rating-label">1 star</span>
                            <div class="progress-bar">
                                <div class="progress" style="width: 1%;"></div>
                            </div>
                            <span class="rating-percent">1%</span>
                        </div>
                    </div>
                </div>
                
                <div class="review-list" id="review-page-1">
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>David Wilson</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">2 weeks ago</span>
                        </div>
                        <p class="review-text">
                            This course was eye-opening! I never realized how sophisticated phishing attacks have become. The interactive exercises were particularly helpful in applying what I learned. I've already started implementing the security practices at work.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Jennifer Lee</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">1 month ago</span>
                        </div>
                        <p class="review-text">
                            As someone who works with sensitive data daily, this course was invaluable. Complex concepts were explained in simple terms, and the examples used were relevant to real-world situations.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Robert Johnson</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                            <span class="review-date">2 months ago</span>
                        </div>
                        <p class="review-text">
                            Great content overall. The section on psychological triggers was particularly interesting. Would recommend to anyone looking to improve their security awareness.
                        </p>
                    </div>
                </div>

                <div class="review-list" id="review-page-2" style="display: none;">
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Sarah Thompson</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">3 weeks ago</span>
                        </div>
                        <p class="review-text">
                            The simulated phishing examples were incredibly realistic. It really helped me understand what to look for in suspicious emails. The course has made me much more confident in identifying threats.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Michael Chen</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">1.5 months ago</span>
                        </div>
                        <p class="review-text">
                            Excellent course structure and progression. The hands-on exercises really helped reinforce the concepts. I particularly appreciated the section on mobile phishing threats.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Emily Rodriguez</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span class="review-date">2.5 months ago</span>
                        </div>
                        <p class="review-text">
                            Very practical approach to phishing awareness. The real-world examples and case studies made the content relatable and memorable.
                        </p>
                    </div>
                </div>

                <div class="review-list" id="review-page-3" style="display: none;">
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>James Wilson</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">3 months ago</span>
                        </div>
                        <p class="review-text">
                            The course content's expertise really shines through. The tips for identifying sophisticated phishing attempts were particularly valuable for our organization.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Lisa Anderson</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">3.5 months ago</span>
                        </div>
                        <p class="review-text">
                            Comprehensive coverage of phishing techniques and prevention strategies. The quizzes after each section helped reinforce the learning effectively.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Daniel Kim</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                            <span class="review-date">4 months ago</span>
                        </div>
                        <p class="review-text">
                            Well-structured content with good examples. The interactive elements kept me engaged throughout the course. Very practical for daily work scenarios.
                        </p>
                    </div>
                </div>

                <div class="review-list" id="review-page-4" style="display: none;">
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Rachel Green</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">4.5 months ago</span>
                        </div>
                        <p class="review-text">
                            The course exceeded my expectations. The section on spear phishing was particularly enlightening. I feel much better equipped to protect myself and my team.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Thomas Brown</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="review-date">5 months ago</span>
                        </div>
                        <p class="review-text">
                            Outstanding course material and delivery. The practical exercises helped me understand how to implement security measures in real-world situations.
                        </p>
                    </div>
                    
                    <div class="review-item">
                        <div class="reviewer-info">
                            <h4>Sophie Martinez</h4>
                            <div class="review-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span class="review-date">5.5 months ago</span>
                        </div>
                        <p class="review-text">
                            Great introduction to phishing awareness. The course provides a solid foundation for anyone looking to improve their cybersecurity knowledge.
                        </p>
                    </div>
                </div>
                
                <div class="review-pagination">
                    <div class="pagination-dots">
                        <span class="dot active" onclick="showReviewPage(1)"></span>
                        <span class="dot" onclick="showReviewPage(2)"></span>
                        <span class="dot" onclick="showReviewPage(3)"></span>
                        <span class="dot" onclick="showReviewPage(4)"></span>
                    </div>
                </div>

                <script>
                    function showReviewPage(pageNumber) {
                        // Hide all review pages
                        document.querySelectorAll('.review-list').forEach(page => {
                            page.style.display = 'none';
                        });
                        
                        // Show selected page
                        document.getElementById('review-page-' + pageNumber).style.display = 'block';
                        
                        // Update active dot
                        document.querySelectorAll('.dot').forEach(dot => {
                            dot.classList.remove('active');
                        });
                        document.querySelectorAll('.dot')[pageNumber - 1].classList.add('active');
                    }
                </script>
                <style>
                    .pagination-dots {
                        display: flex;
                        justify-content: center;
                        gap: 8px;
                        margin: 20px 0;
                    }
                    .pagination-dots .dot {
                        width: 12px;
                        height: 12px;
                        background-color: #FFE600;
                        border-radius: 50%;
                        cursor: pointer;
                        transition: background-color 0.3s ease;
                    }
                    .pagination-dots .dot.active {
                        background-color: #FF0000;
                    }
                </style>
            </div>
        </div>
    </section>

    <!-- Related Courses -->
    <section class="related-courses">
        <div class="container">
            <h2>Related Courses</h2>
            <div class="courses-grid">
                <div class="course-card">
                    <div class="course-image">
                        <img src="images/Password Security .jpg" alt="Password Security">
                        <div class="course-badge beginner">Beginner</div>
                    </div>
                    <div class="course-content">
                        <h3>Password Security</h3>
                        <p>Master the fundamentals of creating and managing secure passwords across multiple platforms.</p>
                        <div class="course-meta">
                            <span><i class="fas fa-clock"></i> 1.5 hours</span>
                            <span><i class="fas fa-users"></i> 2,130 enrolled</span>
                        </div>
                        <a href="course-password-security.html" class="btn btn-course">Start Course</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Enrollment CTA -->
    <section class="course-cta">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to enhance your phishing awareness skills?</h2>
                <p>Join 1,245+ professionals who have already completed this course</p>
                <a href="#overview" class="btn btn-cta" onclick="showTab('overview')">Enroll Now</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3 class="platform-name-styled"><span class="cyber-part">Cyber</span><span class="tech-part">Tech</span></h3>
                    <p class="platform-description">An interactive cybersecurity awareness platform designed to empower employees with practical skills to navigate the digital world safely.</p>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/profile.php?id=61578401008909"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.instagram.com/noor.dmin/?igsh=cnp1d2l3cHp6eTdn#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="index.html#courses">Courses</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Courses</h4>
                    <ul>
                        <li><a href="course-phishing.html">Phishing Awareness</a></li>
                        <li><a href="course-password-security.html">Password Security</a></li>
                        <li><a href="course-data-protection.html">Data Protection</a></li>
                        <li><a href="course-social-engineering.html">Social Engineering</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contact Us</h4>
                    <ul class="contact-info">
                        <li><i class="fas fa-map-marker-alt"></i> 101 CyberTech, St London SE1</li>
                        <li><i class="fas fa-phone"></i> +44 20 7123 4567</li>
                        <li><i class="fas fa-envelope"></i> Admin@cybertech.com</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 <span class="platform-name platform-name-styled"><span class="cyber-part">Cyber</span><span class="tech-part">Tech</span></span>. All rights reserved.</p>
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Video Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-content">
            <div class="video-modal-header">
                <h3 id="videoTitle">Video Title</h3>
                <span class="close-video-modal" onclick="closeVideoModal()">&times;</span>
            </div>
            <div class="video-modal-body">
                <div class="video-container" style="position: relative;">
                    <div id="video-loading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none; text-align: center;">
                        <div style="color: white; font-size: 24px; margin-bottom: 10px;">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                        <div style="color: white; font-size: 14px;">Loading video...</div>
                    </div>
                    <video id="courseVideo" controls controlsList="nodownload" playsinline preload="auto" style="width: 100%; height: 400px; max-height: 70vh; background: #000; display: block; object-fit: contain;">
                        <p>Your browser does not support the video tag.</p>
                    </video>
                </div>
                <div class="video-info">
                    <p id="videoDuration">Duration: <span id="durationText">0 min</span></p>
                    <p>Click play to start the lesson. You can pause and resume at any time.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>

    <!-- Phishing Types Modal -->
    <div id="phishingTypesModal" class="reading-modal">
        <div class="reading-modal-content">
            <div class="reading-modal-header">
                <h3>Common Types of Phishing Attacks</h3>
                <span class="reading-modal-close" onclick="closePhishingTypesModal()">&times;</span>
            </div>
            <div class="phishing-types-container">
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h4>Email Phishing</h4>
                    <p>Phishing emails that impersonate legitimate organizations to steal credentials or install malware.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>An email claiming to be from your bank asking you to verify your account details by clicking a link.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-fish"></i>
                    </div>
                    <h4>Spear Phishing</h4>
                    <p>Targeted attacks using personalized information to appear more convincing to specific individuals.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Email appearing to be from your CEO requesting an urgent wire transfer.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-crown" style="color: white; font-size: 18px;"></i>
                    </div>
                    <h4>Whaling</h4>
                    <p>Highly targeted phishing attacks specifically aimed at senior executives and high-profile targets.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Fake legal document requiring immediate executive attention and action.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h4>Smishing (SMS Phishing)</h4>
                    <p>Phishing attacks conducted through SMS text messages on mobile devices.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Text message claiming you've won a prize and need to click a link to claim it.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <h4>Vishing (Voice Phishing)</h4>
                    <p>Phone-based phishing attacks using voice calls to deceive victims.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Calls claiming to be from tech support about your computer being infected.</p>
                    </div>
                </div>
                
                <div class="phishing-card">
                    <div class="phishing-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <h4>Clone Phishing</h4>
                    <p>Duplicating legitimate emails with malicious attachments or links.</p>
                    <div class="example-box">
                        <h5><i class="fas fa-info-circle"></i> Example:</h5>
                        <p>Copy of a real delivery notification email with modified tracking link.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Reading Modal Styles */
        .reading-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            overflow: auto;
        }
        
        .reading-modal-content {
            position: relative;
            background-color: #fff;
            margin: 5% auto;
            width: 90%;
            max-width: 1200px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .reading-modal-header {
            background-color: #4e54c8;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .reading-modal-header h3 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }
        
        .reading-modal-close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .reading-modal-close:hover {
            color: #ddd;
        }
        
        .phishing-types-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .phishing-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
            position: relative;
        }
        
        .phishing-icon {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 40px;
            height: 40px;
            background: #4e54c8;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .phishing-card h4 {
            margin: 0 0 15px 60px;
            color: #333;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .phishing-card p {
            margin: 0 0 20px 60px;
            color: #666;
            line-height: 1.6;
        }
        
        .example-box {
            background: #f8f9fa;
            border-left: 4px solid #4e54c8;
            padding: 15px;
            margin-left: 60px;
            border-radius: 5px;
        }
        
        .example-box h5 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .example-box h5 i {
            color: #ffc107;
        }
        
        .example-box p {
            margin: 0;
            color: #666;
            line-height: 1.5;
        }
    </style>

    <script>
        // Function to open phishing types modal
        function openPhishingTypesModal() {
            console.log('🎯 Opening phishing types modal');
            const modal = document.getElementById('phishingTypesModal');
            if (modal) {
                modal.style.display = 'block';
                modal.style.visibility = 'visible';
                modal.style.opacity = '1';
                modal.style.zIndex = '9999';
                document.body.style.overflow = 'hidden';
                console.log('✅ Opened phishing types modal');
            } else {
                console.error('❌ Phishing types modal not found');
            }
        }

        // Function to close phishing types modal
        function closePhishingTypesModal() {
            console.log('🎯 Closing phishing types modal');
            const modal = document.getElementById('phishingTypesModal');
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = '';
                console.log('✅ Closed phishing types modal');
            }
        }

        // Make functions globally accessible
        window.openPhishingTypesModal = openPhishingTypesModal;
        window.closePhishingTypesModal = closePhishingTypesModal;

        // Initialize modal functionality
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🔍 Initializing phishing types modal');
            const phishingModal = document.getElementById('phishingTypesModal');
            
            if (phishingModal) {
                console.log('✅ Found phishing types modal');
                
                // Set up click handler for closing modal when clicking outside
                phishingModal.onclick = function(e) {
                    if (e.target === phishingModal) {
                        closePhishingTypesModal();
                    }
                };
                
                // Set up click handler for the close button
                const closeButton = phishingModal.querySelector('.reading-modal-close');
                if (closeButton) {
                    closeButton.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        closePhishingTypesModal();
                    };
                }
            } else {
                console.error('❌ Phishing types modal not found');
            }
        });
    </script>
    
    <script>
        function openVideoModal(title, videoId, duration) {
            const modal = document.getElementById('videoModal');
            const videoTitle = document.getElementById('videoTitle');
            const durationText = document.getElementById('durationText');
            const video = document.getElementById('courseVideo');
            
            // Set video details
            videoTitle.textContent = title;
            durationText.textContent = duration + ' min';
            
            console.log('Looking for video with title:', title);
            
            // Try to load video from user videos (uploaded by admin)
            const userVideos = JSON.parse(localStorage.getItem('cybertech_user_videos') || '[]');
            console.log('Available user videos:', userVideos);
            
            // PRIORITIZE UPLOADED VIDEOS OVER SAMPLE VIDEOS
            
            // Strategy 1: Find uploaded videos with exact title match
            let matchedVideo = userVideos.find(v => 
                v.isUploadedFile === true &&
                v.title.toLowerCase() === title.toLowerCase()
            );
            
            // Strategy 2: Find uploaded videos with partial title match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.isUploadedFile === true &&
                    (v.title.toLowerCase().includes(title.toLowerCase()) ||
                     title.toLowerCase().includes(v.title.toLowerCase()))
                );
            }
            
            // Strategy 3: Find any uploaded video for phishing course
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.isUploadedFile === true &&
                    v.courseName && v.courseName.toLowerCase().includes('phishing')
                );
            }
            
            // Strategy 4: Find any uploaded video at all
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => v.isUploadedFile === true);
            }
            
            // FALLBACK TO SAMPLE VIDEOS ONLY IF NO UPLOADED VIDEOS EXIST
            
            // Strategy 5: Sample videos - exact title match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.title.toLowerCase() === title.toLowerCase()
                );
            }
            
            // Strategy 6: Sample videos - partial title match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.title.toLowerCase().includes(title.toLowerCase()) ||
                    title.toLowerCase().includes(v.title.toLowerCase())
                );
            }
            
            // Strategy 7: Sample videos - any from phishing course
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.courseName && v.courseName.toLowerCase().includes('phishing')
                );
            }
            
            console.log('Matched video:', matchedVideo);
            console.log('Is uploaded file:', matchedVideo?.isUploadedFile);
            
            if (matchedVideo && matchedVideo.videoUrl) {
                if (matchedVideo.isUploadedFile) {
                    console.log('✅ USING ADMIN UPLOADED VIDEO:', matchedVideo.title);
                    console.log('Video is a real uploaded file');
                } else {
                    console.log('⚠️ Using sample video:', matchedVideo.title);
                    console.log('No uploaded video found, falling back to sample');
                }
                console.log('Video URL:', matchedVideo.videoUrl);
                
                // Check if the URL is a data URL (from file upload) or regular URL
                if (matchedVideo.videoUrl.startsWith('data:')) {
                    console.log('Data URL detected - this is a real uploaded file');
                video.src = matchedVideo.videoUrl;
                } else if (matchedVideo.videoUrl.startsWith('blob:')) {
                    console.log('Blob URL detected, this may not work across sessions');
                    video.src = matchedVideo.videoUrl;
                    
                    // Add error handler for blob URLs that may have expired
                    video.onerror = function() {
                        console.log('Blob URL failed, using sample video');
                        video.src = 'videos/courses/Phishing 1.mp4';
                        video.load();
                    };
                } else {
                    video.src = matchedVideo.videoUrl;
                }
                
                // Set video title and duration from matched video
                videoTitle.textContent = matchedVideo.title || title;
                durationText.textContent = (matchedVideo.duration || duration) + ' min';
                
                // Set video properties for better display
                video.style.display = 'block';
                video.style.width = '100%';
                video.style.height = '400px';
                video.style.backgroundColor = '#000';
                video.style.objectFit = 'contain';
                video.style.opacity = '1';
                
                // Force reload and play
                video.load();
                
                // Play when ready
                video.oncanplay = function() {
                    video.play().catch(function(error) {
                        console.error('Error playing video:', error);
                    });
                };
            } else {
                console.log('No video found, using default phishing video');
                
                // Set default video as last resort
                video.src = 'videos/courses/Phishing 1.mp4';
                videoTitle.textContent = title + ' (Default Video)';
                durationText.textContent = duration + ' min';
                
                // Set video properties for better display
                video.style.display = 'block';
                video.style.width = '100%';
                video.style.height = '400px';
                video.style.backgroundColor = '#000';
                video.style.objectFit = 'contain';
                video.style.opacity = '1';
                
                // Force reload and play
                video.load();
                
                // Play when ready
                video.oncanplay = function() {
                    video.play().catch(function(error) {
                        console.error('Error playing video:', error);
                    });
                };
            }
            
            // Show modal
            modal.style.display = 'block';
        }
        
        function closeVideoModal() {
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('courseVideo');
            
            // Stop video playback
            video.pause();
            video.currentTime = 0;
            
            // Clean up any blob URLs to prevent memory leaks
            if (video.src && video.src.startsWith('blob:')) {
                URL.revokeObjectURL(video.src);
            }
            
            // Reset video element
            video.removeAttribute('src');
            video.load();
            
            // Hide modal
            modal.style.display = 'none';
        }
    </script>
    
    <style>
        /* Review Form Styles */
        .review-form-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .review-form-container h3 {
            margin-bottom: 5px;
            color: #333;
        }
        
        .review-form-container p {
            color: #666;
            margin-bottom: 20px;
        }
        
        .review-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .rating-input p {
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .star-rating {
            display: flex;
            gap: 5px;
            font-size: 24px;
            color: #ffc107;
            cursor: pointer;
        }
        
        .star-rating i:hover,
        .star-rating i.fas {
            color: #ffc107;
        }
        
        .comment-input label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .comment-input textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            resize: vertical;
            font-family: 'Poppins', sans-serif;
        }
        
        .review-form button {
            align-self: flex-start;
            padding: 10px 20px;
        }
        
        .review-success {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
    
    <script>
        // Function to update styled platform names
        function updateStyledPlatformNames() {
            // Get platform name from settings manager if available
            let platformName = 'CyberTech'; // Default
            if (window.SettingsManager && window.SettingsManager.getPlatformInfo) {
                const platformInfo = window.SettingsManager.getPlatformInfo();
                if (platformInfo && platformInfo.platformName) {
                    platformName = platformInfo.platformName;
                }
            }
            
            // Find all platform-name-styled elements
            const styledElements = document.querySelectorAll('.platform-name-styled');
            
            styledElements.forEach(element => {
                // Split the platform name - first part is "Cyber" in blue, rest is in green
                let nameParts = platformName.split(/\s+/);
                let firstPart = 'Cyber';
                let restPart = 'Tech';
                
                if (nameParts.length >= 1) {
                    firstPart = nameParts[0];
                    restPart = nameParts.slice(1).join(' ');
                    
                    // If there's only one word, use first 5 chars as first part and rest as second part
                    if (restPart === '' && firstPart.length > 5) {
                        restPart = firstPart.substring(5);
                        firstPart = firstPart.substring(0, 5);
                    } else if (restPart === '') {
                        restPart = 'Tech'; // Default second part if first part is short
                    }
                }
                
                // Update the HTML
                element.innerHTML = `<span class="cyber-part">${firstPart}</span><span class="tech-part">${restPart}</span>`;
            });
            
            // Update regular platform name elements
            const platformElements = document.querySelectorAll('.platform-name:not(.platform-name-styled)');
            platformElements.forEach(element => {
                element.textContent = platformName;
            });
        }
        
        // Run when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Update styled platform names
            updateStyledPlatformNames();
            
            // Listen for settings changes
            document.addEventListener('settingsChanged', function() {
                updateStyledPlatformNames();
            });
            
            // Initialize tab functionality
            const tabButtons = document.querySelectorAll('.tab-btn');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    showTab(tabId);
                });
            });
            
            // Function to show the selected tab
            function showTab(tabId) {
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Show selected tab content
                document.getElementById(tabId).classList.add('active');
                
                // Update tab buttons
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if(btn.getAttribute('data-tab') === tabId) {
                        btn.classList.add('active');
                    }
                });
            }
            
            // Review Form Functionality
            // Check if user has already submitted a review for this course
            const hasReviewed = false; // Always allow reviews
            const reviewForm = document.getElementById('reviewFormContainer');
            
            if (hasReviewed) {
                // Replace form with thank you message
                reviewForm.innerHTML = `
                    <div class="review-success">
                        <i class="fas fa-check-circle" style="font-size: 24px; margin-bottom: 10px;"></i>
                        <h3>Thank You for Your Feedback!</h3>
                        <p>Your review has been submitted successfully and sent to CyberTech admin.</p>
                    </div>
                `;
            } else {
                // Star rating functionality
                const stars = document.querySelectorAll('.star-rating i');
                const ratingInput = document.getElementById('selectedRating');
                
                stars.forEach(star => {
                    star.addEventListener('mouseover', function() {
                        const rating = this.dataset.rating;
                        highlightStars(rating);
                    });
                    
                    star.addEventListener('mouseout', function() {
                        const currentRating = ratingInput.value;
                        highlightStars(currentRating);
                    });
                    
                    star.addEventListener('click', function() {
                        const rating = this.dataset.rating;
                        ratingInput.value = rating;
                        highlightStars(rating);
                    });
                });
                
                function highlightStars(rating) {
                    stars.forEach(star => {
                        if (star.dataset.rating <= rating) {
                            star.classList.remove('far');
                            star.classList.add('fas');
                        } else {
                            star.classList.remove('fas');
                            star.classList.add('far');
                        }
                    });
                }
                
                // Form submission
                const form = document.getElementById('reviewForm');
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const rating = ratingInput.value;
                    const comment = document.getElementById('reviewComment').value;
                    
                    if (rating === '0') {
                        alert('Please select a rating before submitting.');
                        return;
                    }
                    
                    // Get logged-in user information
                    const currentUser = JSON.parse(localStorage.getItem('cybertech_user') || '{}');
                    const userName = currentUser.username || currentUser.name || 'Anonymous User';
                    const userEmail = currentUser.email || 'No email provided';
                    
                    // Submit review using the global function to ensure it appears at the top for admin
                    if (typeof submitUserReview === 'function') {
                        submitUserReview(userName, userEmail, 'phishing', rating, comment || 'No comment provided');
                    } else {
                        // Fallback if submitUserReview function is not available
                        const feedbackData = {
                            name: userName,
                            email: userEmail,
                            course: 'phishing',
                            rating: rating,
                            comment: comment || 'No comment provided',
                            timestamp: new Date().toISOString(),
                            isNewUserReview: true
                        };
                        
                        // Send to admin feedback system
                        const existingFeedback = JSON.parse(localStorage.getItem('cybertech_feedback') || '[]');
                        existingFeedback.unshift(feedbackData); // Add to beginning
                        localStorage.setItem('cybertech_feedback', JSON.stringify(existingFeedback));
                        
                        // Store for cross-page communication
                        localStorage.setItem('new_user_review', JSON.stringify(feedbackData));
                    }
                    
                    // Show thank you message temporarily
                    reviewForm.innerHTML = `
                        <div class="review-success">
                            <i class="fas fa-check-circle" style="font-size: 24px; margin-bottom: 10px;"></i>
                            <h3>Thank You for Your Feedback!</h3>
                            <p>Your review has been submitted successfully and sent to CyberTech admin.</p>
                        </div>
                    `;
                    
                    // After 5 seconds, show the review form again
                    setTimeout(() => {
                        // Reset the form
                        reviewForm.innerHTML = `
                            <h3>Rate This Course</h3>
                            <p>Share your experience with CyberTech</p>
                            
                            <form id="reviewForm" class="review-form">
                                <div class="rating-input">
                                    <p>Your Rating:</p>
                                    <div class="star-rating">
                                        <i class="far fa-star" data-rating="1"></i>
                                        <i class="far fa-star" data-rating="2"></i>
                                        <i class="far fa-star" data-rating="3"></i>
                                        <i class="far fa-star" data-rating="4"></i>
                                        <i class="far fa-star" data-rating="5"></i>
                                        <input type="hidden" name="rating" id="selectedRating" value="0">
                                    </div>
                                </div>
                                
                                <div class="comment-input">
                                    <label for="reviewComment">Your Comment (Optional):</label>
                                    <textarea id="reviewComment" name="comment" rows="4" placeholder="Share your thoughts about this course..."></textarea>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">Submit Review</button>
                            </form>
                        `;
                        
                        // Reinitialize the star rating functionality
                        const newStars = document.querySelectorAll('.star-rating i');
                        const newRatingInput = document.getElementById('selectedRating');
                        
                        newStars.forEach(star => {
                            star.addEventListener('mouseover', function() {
                                const rating = this.dataset.rating;
                                highlightStars(rating);
                            });
                            
                            star.addEventListener('mouseout', function() {
                                const currentRating = newRatingInput.value;
                                highlightStars(currentRating);
                            });
                            
                            star.addEventListener('click', function() {
                                const rating = this.dataset.rating;
                                newRatingInput.value = rating;
                                highlightStars(rating);
                            });
                        });
                        
                        // Reattach the form submission event
                        const newForm = document.getElementById('reviewForm');
                        if (newForm) {
                            newForm.addEventListener('submit', arguments.callee);
                        }
                    }, 5000); // 5 seconds
                });
            }
        });

        // Function to toggle phishing types content
        // Remove togglePhishingTypes function as we're using the modal now

        // Function to toggle reading lessons content
        function toggleReadingLesson(element) {
            console.log('🎯 toggleReadingLesson called for:', element.querySelector('span')?.textContent);
            const content = element.nextElementSibling;
            const expandIcon = element.querySelector('.expand-icon');
            
            console.log('🔍 Content element:', content);
            console.log('🔍 Expand icon:', expandIcon);
            console.log('🔍 Current content display:', content?.style.display);
            
            // Check if content exists
            if (!content) {
                console.error('❌ No content element found for reading lesson');
                return;
            }
            
            // Check if expandIcon exists
            if (!expandIcon) {
                console.error('❌ No expand icon found for reading lesson');
                return;
            }
            
            if (content.style.display === 'none' || content.style.display === '') {
                // Force the content to be visible
                content.style.display = 'block';
                content.style.visibility = 'visible';
                content.style.opacity = '1';
                content.style.height = 'auto';
                content.style.overflow = 'visible';
                
                // Rotate the expand icon
                expandIcon.classList.add('rotate');
                expandIcon.style.transform = 'rotate(180deg)';
                
                console.log('✅ Reading content expanded successfully');
                console.log('🔍 Content display style:', content.style.display);
                console.log('🔍 Content visibility:', content.style.visibility);
                console.log('🔍 Content opacity:', content.style.opacity);
                
                // Force a reflow to ensure the content is rendered
                content.offsetHeight;
                
            } else {
                content.style.display = 'none';
                expandIcon.classList.remove('rotate');
                expandIcon.style.transform = 'rotate(0deg)';
                console.log('✅ Reading content collapsed successfully');
            }
        }

        // Function to completely block video functionality for reading lessons
        function blockVideoForReadingLessons() {
            const readingLessons = document.querySelectorAll('.lesson-info');
            readingLessons.forEach(lesson => {
                const lessonTitle = lesson.querySelector('span')?.textContent;
                const isReadingLesson = lessonTitle === 'Common Types of Phishing Attacks';
                
                if (isReadingLesson) {
                    // Remove any video-related onclick handlers
                    if (lesson.onclick && lesson.onclick.toString().includes('openVideoModal')) {
                        lesson.onclick = function() { toggleReadingLesson(this); };
                        console.log('🚫 Blocked video onclick for:', lessonTitle);
                    }
                    
                    // Remove video-lesson class if present
                    if (lesson.classList.contains('video-lesson')) {
                        lesson.classList.remove('video-lesson');
                        lesson.classList.add('lesson-expandable');
                        console.log('🚫 Removed video class for:', lessonTitle);
                    }
                    
                    // Ensure document icon
                    const icon = lesson.querySelector('i');
                    if (icon && icon.classList.contains('fa-play-circle')) {
                        icon.className = 'fas fa-file-alt';
                        console.log('🚫 Fixed video icon for:', lessonTitle);
                    }
                }
            });
        }

        // Function to ensure reading lessons maintain correct state
        function ensureReadingLessons() {
            console.log('🔍 Ensuring reading lessons are properly configured...');
            
            const readingLessons = document.querySelectorAll('.lesson-info');
            readingLessons.forEach(lesson => {
                const lessonTitle = lesson.querySelector('span')?.textContent;
                const isReadingLesson = lessonTitle === 'Common Types of Phishing Attacks';
                
                if (isReadingLesson) {
                    console.log('📖 Configuring reading lesson:', lessonTitle);
                    
                    // Ensure it has the correct classes
                    lesson.classList.add('lesson-expandable');
                    lesson.classList.remove('video-lesson');
                    
                    // Ensure it has the correct icon
                    const icon = lesson.querySelector('i');
                    if (icon && !icon.classList.contains('fa-file-alt')) {
                        icon.className = 'fas fa-file-alt';
                        console.log('✅ Fixed icon for:', lessonTitle);
                    }
                    
                    // For reading lessons, ensure no expand icon exists
                    if (isReadingLesson) {
                        const expandIcon = lesson.querySelector('.expand-icon');
                        if (expandIcon) {
                            expandIcon.remove();
                            console.log('✅ Removed expand icon for reading lesson:', lessonTitle);
                        }
                    } else {
                        // For other lessons, ensure expand icon exists
                        let expandIcon = lesson.querySelector('.expand-icon');
                        if (!expandIcon) {
                            expandIcon = document.createElement('i');
                            expandIcon.className = 'fas fa-chevron-down expand-icon';
                            lesson.appendChild(expandIcon);
                            console.log('✅ Added missing expand icon for:', lessonTitle);
                        }
                    }
                    
                    // Set the correct click handler based on lesson type
                    if (isReadingLesson) {
                        lesson.onclick = function() { openPhishingTypesModal(); };
                        console.log('✅ Set modal handler for:', lessonTitle);
                    } else if (!lesson.onclick || !lesson.onclick.toString().includes('toggleReadingLesson')) {
                        lesson.onclick = function() { toggleReadingLesson(this); };
                        console.log('✅ Fixed onclick handler for:', lessonTitle);
                    }
                    
                    // Remove any video-related styling
                    lesson.style.cursor = 'pointer';
                    
                    console.log('✅ Reading lesson configured:', lessonTitle);
                }
            });
        }

        // Set up MutationObserver to watch for changes to lesson elements
        function setupReadingLessonObserver() {
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList' || mutation.type === 'attributes') {
                        // Check if any reading lessons were modified
                        const readingLessons = document.querySelectorAll('.lesson-info');
                        readingLessons.forEach(lesson => {
                            const lessonTitle = lesson.querySelector('span')?.textContent;
                            const isReadingLesson = lessonTitle === 'Common Types of Phishing Attacks';
                            
                            if (isReadingLesson) {
                                // Check if icon was changed to video icon
                                const icon = lesson.querySelector('i');
                                if (icon && icon.classList.contains('fa-play-circle')) {
                                    console.log('🚨 Video icon detected on reading lesson, fixing:', lessonTitle);
                                    icon.className = 'fas fa-file-alt';
                                }
                                
                                // Check if video-lesson class was added
                                if (lesson.classList.contains('video-lesson')) {
                                    console.log('🚨 Video class detected on reading lesson, removing:', lessonTitle);
                                    lesson.classList.remove('video-lesson');
                                    lesson.classList.add('lesson-expandable');
                                }
                                
                                // Ensure correct onclick handler
                                if (!lesson.onclick || !lesson.onclick.toString().includes('toggleReadingLesson')) {
                                    lesson.onclick = function() { toggleReadingLesson(this); };
                                }
                            }
                        });
                    }
                });
            });
            
            // Start observing
            observer.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true,
                attributeFilter: ['class', 'onclick']
            });
            
            console.log('👁️ Reading lesson observer set up');
        }

        // Set up periodic checks to block video functionality
        function setupPeriodicVideoBlocking() {
            setInterval(() => {
                blockVideoForReadingLessons();
            }, 2000); // Check every 2 seconds
            console.log('⏰ Periodic video blocking set up');
        }

        // Debug function to manually show reading content
        function debugShowReadingContent() {
            console.log('🔧 Debug: Manually showing reading content...');
            const readingLesson = document.querySelector('.lesson-info[onclick*="toggleReadingLesson"]');
            if (readingLesson) {
                const content = readingLesson.nextElementSibling;
                if (content) {
                    content.style.display = 'block';
                    content.style.visibility = 'visible';
                    content.style.opacity = '1';
                    content.style.height = 'auto';
                    content.style.overflow = 'visible';
                    console.log('🔧 Debug: Reading content should now be visible');
                    console.log('🔧 Debug: Content element:', content);
                    console.log('🔧 Debug: Content innerHTML length:', content.innerHTML.length);
                } else {
                    console.error('🔧 Debug: No content element found');
                }
            } else {
                console.error('🔧 Debug: No reading lesson found');
            }
        }

        // Video Modal Functions
        function openVideoModal(title, videoId, duration) {
            const modal = document.getElementById('videoModal');
            const videoTitle = document.getElementById('videoTitle');
            const durationText = document.getElementById('durationText');
            const video = document.getElementById('courseVideo');
            
            // Set video details
            videoTitle.textContent = title;
            durationText.textContent = duration + ' min';
            
            console.log('Looking for video with ID:', videoId);
            
            // Try to get video data directly from localStorage
            let videoData = localStorage.getItem(`video_data_${videoId}`);
            
            if (videoData) {
                console.log('✅ Found admin video data');
                // Set video source to the base64 data
                video.src = videoData;
                videoTitle.textContent = title + ' (Admin Video)';
                videoTitle.style.color = '#4CAF50';
                return;
            }
            
            // If no direct video data, try to find in user videos
            const userVideos = JSON.parse(localStorage.getItem('cybertech_user_videos') || '[]');
            console.log('Looking in user videos...');
            
            // Find the video by ID first
            let matchedVideo = userVideos.find(v => v.id === videoId);
            
            // If not found by ID, try to find by title
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.title.toLowerCase() === title.toLowerCase()
                );
            }
            
            // FALLBACK TO SAMPLE VIDEOS ONLY IF NO UPLOADED VIDEOS EXIST
            
            // Strategy 5: Sample videos - exact title match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.title.toLowerCase() === title.toLowerCase()
                );
            }
            
            // Strategy 6: Sample videos - partial title match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.title.toLowerCase().includes(title.toLowerCase()) ||
                    title.toLowerCase().includes(v.title.toLowerCase())
                );
            }
            
            // Strategy 7: Sample videos - lesson name match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.lessonName && v.lessonName.toLowerCase().includes(title.toLowerCase())
                );
            }
            
            // Strategy 8: Sample videos - any from this course
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.courseName && v.courseName.toLowerCase().includes('phishing')
                );
            }
            
            console.log('Matched video:', matchedVideo);
            console.log('Is uploaded file:', matchedVideo?.isUploadedFile);
            
            console.log('Opening video modal for ID:', videoId);
            
            // Update video data from localStorage
            videoData = localStorage.getItem(`video_data_${videoId}`);
            console.log('Video data found:', !!videoData);
            
            // Show modal and loading state
            modal.style.display = 'block';
            const loadingDiv = document.getElementById('video-loading');
            loadingDiv.style.display = 'block';
            video.style.opacity = '0';
            
            if (videoData) {
                console.log('✅ Loading admin video');
                try {
                    // Create blob URL from base64 data
                    const base64Data = videoData;
                    const byteString = atob(base64Data.split(',')[1]);
                    const mimeType = base64Data.split(',')[0].split(':')[1].split(';')[0];
                    
                    const ab = new ArrayBuffer(byteString.length);
                    const ia = new Uint8Array(ab);
                    for (let i = 0; i < byteString.length; i++) {
                        ia[i] = byteString.charCodeAt(i);
                    }
                    
                    const blob = new Blob([ab], { type: mimeType });
                    const blobUrl = URL.createObjectURL(blob);
                    
                    // Set up video
                    video.src = blobUrl;
                    videoTitle.textContent = title + ' (Admin Video)';
                    videoTitle.style.color = '#4CAF50';
                    
                    // Show video when loaded
                    video.onloadeddata = function() {
                        loadingDiv.style.display = 'none';
                        video.style.opacity = '1';
                        console.log('✅ Video loaded successfully');
                    };
                    
                    // Handle errors
                    video.onerror = function(e) {
                        console.error('Error loading video:', e);
                        loadingDiv.style.display = 'none';
                        video.style.opacity = '1';
                        alert('Error loading video. Please try again.');
                    };
                    
                    // Clean up blob URL when done
                    video.onended = function() {
                        URL.revokeObjectURL(blobUrl);
                    };
                    
                } catch (error) {
                    console.error('Error processing video:', error);
                    loadingDiv.style.display = 'none';
                    video.style.opacity = '1';
                    alert('Error processing video. Please try again.');
                }
            } else {
                console.log('⚠️ No admin video found');
                loadingDiv.style.display = 'none';
                video.style.opacity = '1';
                modal.style.display = 'none';
                // Try to play the default video
video.src = 'videos/courses/Phishing 1.mp4';
video.play().catch(function(error) {
    console.error('Error playing default video:', error);
});
            }
            
            // Helper function to convert data URL to blob
            function dataURLtoBlob(dataURL) {
                const arr = dataURL.split(',');
                const mime = arr[0].match(/:(.*?);/)[1];
                const bstr = atob(arr[1]);
                let n = bstr.length;
                const u8arr = new Uint8Array(n);
                while(n--) {
                    u8arr[n] = bstr.charCodeAt(n);
                }
                return new Blob([u8arr], {type: mime});
            }
        }
        
        function closeVideoModal() {
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('courseVideo');
            
            // Hide modal
            modal.style.display = 'none';
            
            // Pause and reset video
            video.pause();
            video.currentTime = 0;
        }
        
        // Close modal when clicking outside of it
        window.addEventListener('click', function(event) {
            const videoModal = document.getElementById('videoModal');
            const phishingModal = document.getElementById('phishingTypesModal');
            
            if (event.target === videoModal) {
                closeVideoModal();
            } else if (event.target === phishingModal) {
                closePhishingTypesModal();
            }
        });

        // Function to open phishing types modal
        function openPhishingTypesModal() {
            console.log('🎯 Opening phishing types modal');
            const modal = document.getElementById('phishingTypesModal');
            if (modal) {
                modal.style.display = 'block';
                modal.style.visibility = 'visible';
                modal.style.opacity = '1';
                modal.style.zIndex = '1000';
                console.log('✅ Opened phishing types modal');
            } else {
                console.error('❌ Phishing types modal not found');
            }
        }

        // Function to close phishing types modal
        function closePhishingTypesModal() {
            console.log('🎯 Closing phishing types modal');
            const modal = document.getElementById('phishingTypesModal');
            if (modal) {
                modal.style.display = 'none';
                console.log('✅ Closed phishing types modal');
            }
        }

        // Make functions globally accessible
        window.openPhishingTypesModal = openPhishingTypesModal;
        window.closePhishingTypesModal = closePhishingTypesModal;
        
        // Function to load and display new videos from admin uploads
        function loadDynamicVideos() {
            console.log('Loading dynamic videos for Phishing course...');
            const userVideos = JSON.parse(localStorage.getItem('cybertech_user_videos') || '[]');
            
            // Filter out the deleted lessons
            const deletedLessons = [
                'Why Phishing Works: Human Psychology',
                'Emotional Triggers Used in Attacks', 
                'Case Studies: Successful Phishing Campaigns'
            ];
            
            const phishingVideos = userVideos.filter(v => 
                v.courseName && 
                v.courseName.toLowerCase().includes('phishing') &&
                !deletedLessons.includes(v.lessonName)
            );
            
            console.log('Found phishing videos:', phishingVideos);
            
            // Update all video lessons
            phishingVideos.forEach(video => {
                // Find matching lesson div
                const lessonDiv = Array.from(document.querySelectorAll('.lesson-info')).find(div => {
                    const lessonText = div.querySelector('span')?.textContent?.trim();
                    return lessonText === video.lessonName;
                });
                
                if (lessonDiv) {
                    console.log('Updating video for lesson:', video.lessonName);
                    
                    // Check if this is a reading lesson
                    const lessonTitle = lessonDiv.querySelector('span')?.textContent;
                    const isReadingLesson = lessonTitle === 'Common Types of Phishing Attacks';
                    
                    // Update lesson styling to show it has a video (but exclude reading lessons)
                    if (!isReadingLesson) {
                    lessonDiv.classList.add('video-lesson');
                    lessonDiv.style.cursor = 'pointer';
                    }
                    
                    // Add play icon if not present (but exclude reading lessons)
                    if (!lessonDiv.querySelector('.fa-play-circle') && !isReadingLesson) {
                        const icon = document.createElement('i');
                        icon.className = 'fas fa-play-circle';
                        lessonDiv.insertBefore(icon, lessonDiv.firstChild);
                    }
                    
                    // Update onclick handler (but exclude reading lessons)
                    if (!isReadingLesson) {
                    lessonDiv.onclick = function() {
                        const modal = document.getElementById('videoModal');
                        const videoPlayer = document.getElementById('courseVideo');
                        const videoTitle = document.getElementById('videoTitle');
                        const durationText = document.getElementById('durationText');
                        const loadingDiv = document.getElementById('video-loading');
                        
                        // Show modal and loading state
                        modal.style.display = 'block';
                        loadingDiv.style.display = 'block';
                        videoPlayer.style.opacity = '0';
                        
                        // Get video data
                        const videoData = localStorage.getItem(`video_data_${video.id}`);
                        
                        if (videoData) {
                            try {
                                // Convert base64 to blob
                                const base64Data = videoData;
                                const byteString = atob(base64Data.split(',')[1]);
                                const mimeType = base64Data.split(',')[0].split(':')[1].split(';')[0];
                                
                                const ab = new ArrayBuffer(byteString.length);
                                const ia = new Uint8Array(ab);
                                for (let i = 0; i < byteString.length; i++) {
                                    ia[i] = byteString.charCodeAt(i);
                                }
                                
                                const blob = new Blob([ab], { type: mimeType });
                                const blobUrl = URL.createObjectURL(blob);
                                
                                // Update video player
                                videoPlayer.src = blobUrl;
                                videoTitle.textContent = video.lessonName;
                                durationText.textContent = video.duration + ' min';
                                
                                // Show video when loaded
                                videoPlayer.onloadeddata = function() {
                                    loadingDiv.style.display = 'none';
                                    videoPlayer.style.opacity = '1';
                                    videoPlayer.play();
                                };
                                
                                // Clean up blob URL when done
                                videoPlayer.onended = function() {
                                    URL.revokeObjectURL(blobUrl);
                                };
                            } catch (error) {
                                console.error('Error loading video:', error);
                                loadingDiv.style.display = 'none';
                                videoPlayer.style.opacity = '1';
                            }
                        }
                    };
                    }
                    
                    // Dispatch event to notify other components
                    window.dispatchEvent(new CustomEvent('newVideoAdded', {
                        detail: { video: video }
                    }));
                }
            });
        }
        
        function updateLessonList(videos) {
            // Group videos by module
            const moduleGroups = {};
            videos.forEach(video => {
                const moduleName = video.moduleName || 'General';
                if (!moduleGroups[moduleName]) {
                    moduleGroups[moduleName] = [];
                }
                moduleGroups[moduleName].push(video);
            });
            
            console.log('Grouped videos by module:', moduleGroups);
            
            // Add new video lessons to the course
            Object.keys(moduleGroups).forEach(moduleName => {
                const moduleVideos = moduleGroups[moduleName];
                moduleVideos.forEach(video => {
                    addDynamicVideoLesson(video);
                });
            });
        }
        
        // Function to clean up deleted lessons from the DOM
        function cleanupDeletedLessons() {
            console.log('🧹 Cleaning up deleted lessons...');
            
            const deletedLessons = [
                'Why Phishing Works: Human Psychology',
                'Emotional Triggers Used in Attacks', 
                'Case Studies: Successful Phishing Campaigns'
            ];
            
            // Clean up localStorage data for deleted lessons
            const userVideos = JSON.parse(localStorage.getItem('cybertech_user_videos') || '[]');
            const filteredVideos = userVideos.filter(video => !deletedLessons.includes(video.lessonName));
            localStorage.setItem('cybertech_user_videos', JSON.stringify(filteredVideos));
            
            // Clean up video data keys for deleted lessons
            deletedLessons.forEach(lessonName => {
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.includes(lessonName.replace(/\s+/g, '_'))) {
                        keysToRemove.push(key);
                    }
                }
                keysToRemove.forEach(key => {
                    localStorage.removeItem(key);
                    console.log('🗑️ Removed localStorage key:', key);
                });
            });
            
            // Find and remove any lesson elements that match deleted lesson names
            deletedLessons.forEach(lessonName => {
                const lessonElements = document.querySelectorAll('.lesson-info');
                lessonElements.forEach(element => {
                    const lessonText = element.querySelector('span')?.textContent?.trim();
                    if (lessonText === lessonName) {
                        console.log('🗑️ Removing deleted lesson:', lessonName);
                        const lessonItem = element.closest('li');
                        if (lessonItem) {
                            lessonItem.remove();
                        }
                    }
                });
            });
            
            console.log('✅ Cleanup completed');
        }
        
        // Manual cleanup function for browser console
        window.cleanupDeletedPhishingLessons = function() {
            console.log('🧹 Manual cleanup of deleted phishing lessons...');
            cleanupDeletedLessons();
            console.log('🔄 Refreshing page to ensure clean state...');
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        };
        
        function addDynamicVideoLesson(video) {
            // Find the first lesson list to add the video
            const lessonLists = document.querySelectorAll('.lessons-list');
            if (lessonLists.length > 0) {
                const firstList = lessonLists[0];
                
                // Check if video lesson already exists
                const existingLesson = Array.from(firstList.querySelectorAll('.video-lesson')).find(lesson => 
                    lesson.onclick && lesson.onclick.toString().includes(video.title)
                );
                
                if (!existingLesson) {
                    // Create new lesson item
                    const newLesson = document.createElement('li');
                    newLesson.innerHTML = `
                        <div class="lesson-info video-lesson" onclick="openVideoModal('${video.title}', '${video.id}', ${video.duration})">
                            <i class="fas fa-play-circle"></i>
                            <span>${video.title} <span style="color: #28a745; font-weight: bold;">(NEW)</span></span>
                        </div>
                        <span class="lesson-length">${video.duration} min</span>
                    `;
                    
                    // Add to the top of the list
                    firstList.insertBefore(newLesson, firstList.firstChild);
                    
                    console.log('Added dynamic video lesson:', video.title);
                }
            }
        }
        
        function showNewVideoNotification(count) {
            // Check if user is admin before showing notification
            if (typeof window.isAdminUser === 'function' && !window.isAdminUser()) {
                console.log('New video notification suppressed for regular user');
                return; // Don't show notifications to regular users
            }
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'new-video-notification';
            notification.innerHTML = `
                <span><i class="fas fa-video"></i> ${count} new video(s) available!</span>
                <button class="close-btn">×</button>
            `;
            
            // Style the notification
            notification.style.cssText = `
                position: fixed;
                top: 60px;
                left: 50%;
                transform: translateX(-50%);
                background-color: #4CAF50;
                color: white;
                padding: 10px 20px;
                border-radius: 4px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                z-index: 1000;
                display: flex;
                align-items: center;
                gap: 10px;
            `;
            
            // Add close button functionality
            const closeBtn = notification.querySelector('.close-btn');
            closeBtn.style.cssText = `
                background: none;
                border: none;
                color: white;
                font-size: 18px;
                cursor: pointer;
                margin-left: 10px;
            `;
            closeBtn.addEventListener('click', () => notification.remove());
            
            // Add to page
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // Load dynamic videos when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                // Clean up any deleted lessons that might be present
                cleanupDeletedLessons();
                loadDynamicVideos();
                blockVideoForReadingLessons(); // Block video functionality for reading lessons
                ensureReadingLessons(); // Ensure reading lessons are properly configured
                setupReadingLessonObserver(); // Set up observer to watch for changes
                setupPeriodicVideoBlocking(); // Set up periodic video blocking
            }, 1000);
        });
        
        // Listen for new video additions from admin panel
        window.addEventListener('newVideoAdded', function(event) {
            console.log('New video added event received:', event.detail);
            const newVideo = event.detail.video;
            
            // Check if this video belongs to the Phishing course
            if (newVideo.courseName && newVideo.courseName.toLowerCase().includes('phishing')) {
                console.log('New phishing video detected, adding to course page');
                addDynamicVideoLesson(newVideo);
                showNewVideoNotification(1);
            }
        });
        
        // Listen for storage changes (for cross-tab updates)
        window.addEventListener('storage', function(event) {
            if (event.key === 'cybertech_user_videos') {
                console.log('User videos storage changed, reloading...');
                setTimeout(() => {
                    loadDynamicVideos();
                    ensureReadingLessons(); // Re-ensure reading lessons after video updates
                }, 500);
            }
            
            // Listen for template updates
            if (event.key === 'cybertech_overview_templates_last_update') {
                console.log('Template updates detected, refreshing course content...');
                setTimeout(() => {
                    if (typeof checkAndApplyTemplateUpdates === 'function') {
                        checkAndApplyTemplateUpdates();
                    }
                    ensureReadingLessons(); // Re-ensure reading lessons after template updates
                }, 500);
            }
        });
    </script>
        <script>
            // Global video initialization
            function initializeAllVideos() {
                console.log('🎥 Initializing all videos...');
                
                // Get all video lessons
                const videoLessons = document.querySelectorAll('.video-lesson');
                console.log('Found video lessons:', videoLessons.length);
                
                // Get admin videos from storage
                const userVideos = JSON.parse(localStorage.getItem('cybertech_user_videos') || '[]');
                console.log('Available admin videos:', userVideos);
                
                // Initialize each video lesson
                videoLessons.forEach(lessonDiv => {
                    console.log('Setting up lesson:', lessonDiv.id);
                    
                    // Remove any existing click listeners
                    const newLessonDiv = lessonDiv.cloneNode(true);
                    lessonDiv.parentNode.replaceChild(newLessonDiv, lessonDiv);
                    
                    // Find matching admin video
                    let adminVideo = null;
                    
                    // Match based on lesson ID
                    if (newLessonDiv.id === 'what-is-phishing-lesson') {
                        adminVideo = userVideos.find(v => 
                            v.isUploadedFile === true && 
                            v.courseName === 'Phishing Awareness' &&
                            v.moduleName === 'Introduction to Phishing' &&
                            v.lessonName === 'What is Phishing?'
                        );
                    } else if (newLessonDiv.id === 'phishing-history-lesson') {
                        adminVideo = userVideos.find(v => 
                            v.isUploadedFile === true && 
                            v.courseName === 'Phishing Awareness' &&
                            v.moduleName === 'Introduction to Phishing' &&
                            v.lessonName === 'The History and Evolution of Phishing Attacks'
                        );
                    }
                    
                    console.log('Found admin video for', newLessonDiv.id, ':', adminVideo);
                    
                    // Get duration span
                    const durationSpan = document.getElementById(newLessonDiv.id.replace('lesson', 'duration'));
                    
                    if (adminVideo) {
                        console.log('Setting up admin video for:', newLessonDiv.id);
                        
                        // Check if video data exists
                        const videoData = localStorage.getItem(`video_data_${adminVideo.id}`);
                        if (!videoData) {
                            console.error('Video data not found for:', adminVideo.id);
                            return;
                        }
                        
                        // Update UI for admin video
                        if (durationSpan) {
                            durationSpan.textContent = adminVideo.duration + ' min';
                        }
                        newLessonDiv.classList.add('admin-video');
                        newLessonDiv.innerHTML = `
                            <i class="fas fa-play-circle"></i>
                            <span>${adminVideo.title} <small style="color: #4CAF50;">(Admin Video)</small></span>
                        `;
                        
                        // Set up click handler for admin video
                        newLessonDiv.addEventListener('click', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            console.log('🎬 Playing admin video:', adminVideo.id);
                            openVideoModal(adminVideo.title, adminVideo.id, adminVideo.duration);
                        });
                        
                    } else {
                        console.log('Setting up sample video for:', newLessonDiv.id);
                        
                        // Set up click handler for sample video
                        if (newLessonDiv.id === 'what-is-phishing-lesson') {
                            newLessonDiv.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                console.log('🎬 Playing sample video: What is Phishing?');
                                openVideoModal('What is Phishing?', 'phishing_intro_video', 8);
                            });
                        } else if (newLessonDiv.id === 'phishing-history-lesson') {
                            newLessonDiv.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                console.log('🎬 Playing sample video: History');
                                openVideoModal('The History and Evolution of Phishing Attacks', 'phishing_history_video', 10);
                            });
                        }
                    }
                });
            }
            
            // Initialize videos on page load
            document.addEventListener('DOMContentLoaded', function() {
                console.log('🌟 Page loaded, initializing videos...');
                initializeAllVideos();
            });
            
            // Re-initialize when storage changes
            window.addEventListener('storage', function(e) {
                if (e.key === 'cybertech_user_videos' || e.key?.startsWith('video_data_')) {
                    console.log('📦 Storage changed, reinitializing videos...');
                    initializeAllVideos();
                }
            });
            
            // Email-based exercise for Spot the Phish - 5 QUESTIONS
            window.phishingEmails = [
                {
                    sender: "Amazon Customer Service <amazon-support@amazn-services.com>",
                    subject: "Urgent: Your Amazon Account Has Been Suspended",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Amazon Customer Service &lt;amazon-support@amazn-services.com&gt;</div>
                            <div><strong>Subject:</strong> Urgent: Your Amazon Account Has Been Suspended</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <p>Dear Valued Customer,</p>
                            <p>We regret to inform you that your Amazon account has been temporarily suspended due to failed verification of your billing information.</p>
                            <p>To restore your account access, please verify your information by clicking the link below:</p>
                            <p><a href="#" style="color: blue; text-decoration: underline;">https://amazn-account-verify.com/restore-account</a></p>
                            <p>If you do not verify your account within 24 hours, your account will be permanently deactivated.</p>
                            <p>Thank you for your cooperation.</p>
                            <p>Amazon Customer Service Team</p>
                        </div>
                    </div>`,
                    isPhishing: true,
                    redFlags: [
                        "Misspelled domain in email address (amazn-services.com instead of amazon.com)",
                        "Creates urgency with threats of account suspension",
                        "Suspicious link URL (amazn-account-verify.com is not an Amazon domain)",
                        "Generic greeting ('Valued Customer' instead of your name)"
                    ]
                },
                {
                    sender: "PayPal <service@paypal.com>",
                    subject: "Your account has been limited until we hear from you",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> PayPal &lt;service@paypal.com&gt;</div>
                            <div><strong>Subject:</strong> Your account has been limited until we hear from you</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <img src="https://www.paypalobjects.com/webstatic/i/logo/rebrand/ppcom.svg" alt="PayPal Logo" style="height: 40px; margin-bottom: 15px;">
                            <p>We noticed some unusual activity in your account. To ensure your account safety, we've temporarily limited some features.</p>
                            <p>Please log in to your PayPal account to verify your information:</p>
                            <p style="text-align: center;">
                                <a href="https://www.paypal.com/signin" style="background-color: #0070ba; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">Log In to PayPal</a>
                            </p>
                            <p>If you don't recognize this activity, please secure your account by changing your password after logging in.</p>
                            <p>Thank you for your prompt attention to this matter.</p>
                            <p>PayPal Customer Service</p>
                        </div>
                    </div>`,
                    isPhishing: false,
                    legitimateFeatures: [
                        "Correct sender domain (paypal.com)",
                        "Link goes to the actual PayPal website",
                        "No request for personal information via email",
                        "Professional design with proper branding",
                        "No spelling or grammar errors"
                    ]
                },
                {
                    sender: "Bank of America <secure@bankofamerica.com>",
                    subject: "URGENT: Unauthorized Access Detected",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Bank of America &lt;secure@bankofamerica.com&gt;</div>
                            <div><strong>Subject:</strong> URGENT: Unauthorized Access Detected</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <img src="https://1000logos.net/wp-content/uploads/2016/10/Bank-of-America-Logo.png" alt="Bank of America Logo" style="height: 40px; margin-bottom: 15px;">
                            <p>Dear Valued Customer,</p>
                            <p>Our security system has detected unauthorized access attempts to your online banking account. For your protection, we have temporarily restricted access to your account.</p>
                            <p>To restore access immediately, please verify your identity by clicking the link below and confirming your account details:</p>
                            <p><a href="#" style="color: blue; text-decoration: underline;">https://secure-bankofamerica.com-verify.us/login</a></p>
                            <p>If you do not verify your account within 24 hours, your account will be suspended.</p>
                            <p>Thank you for your cooperation.</p>
                            <p>Bank of America Security Team</p>
                        </div>
                    </div>`,
                    isPhishing: true,
                    redFlags: [
                        "Suspicious URL (secure-bankofamerica.com-verify.us is not a Bank of America domain)",
                        "Creates urgency with 'URGENT' in the subject and threats of account suspension",
                        "Generic greeting ('Valued Customer')",
                        "Requests verification of account details via a link",
                        "Threatening tone with time pressure (24 hours)"
                    ]
                },
                {
                    sender: "Netflix <info@mailer.netflix.com>",
                    subject: "Your Netflix payment didn't go through",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Netflix &lt;info@mailer.netflix.com&gt;</div>
                            <div><strong>Subject:</strong> Your Netflix payment didn't go through</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png" alt="Netflix Logo" style="height: 40px; margin-bottom: 15px;">
                            <p>Hi there,</p>
                            <p>We're having some trouble with your current billing information. We'll try again, but to avoid any interruption of your service, please update your payment details.</p>
                            <p style="text-align: center;">
                                <a href="https://www.netflix.com/YourAccount" style="background-color: #e50914; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">Update Payment Information</a>
                            </p>
                            <p>If you need help, visit the <a href="https://help.netflix.com/">Netflix Help Center</a>.</p>
                            <p>–Your friends at Netflix</p>
                        </div>
                    </div>`,
                    isPhishing: false,
                    legitimateFeatures: [
                        "Correct sender domain (mailer.netflix.com is a legitimate Netflix email domain)",
                        "Link goes to the actual Netflix website",
                        "Professional design with proper branding",
                        "No urgent threats or extreme consequences mentioned",
                        "Provides alternative help options"
                    ]
                },
                {
                    sender: "Microsoft Security Team <security@microsoft.com>",
                    subject: "Your Microsoft Account: Action Required",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Microsoft Security Team &lt;security@microsoft.com&gt;</div>
                            <div><strong>Subject:</strong> Your Microsoft Account: Action Required</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <p>Hello,</p>
                            <p>We detected unusual sign-in activity on your Microsoft account. To secure your account, we've temporarily limited access.</p>
                            <p>Please verify your identity by confirming your account details at:</p>
                            <p><a href="#" style="color: blue; text-decoration: underline;">https://security-microsoft-verify.net/account</a></p>
                            <p>This link will expire in 24 hours.</p>
                            <p>Microsoft Security</p>
                        </div>
                    </div>`,
                    isPhishing: true,
                    redFlags: [
                        "Suspicious link URL (security-microsoft-verify.net is not a Microsoft domain)",
                        "Creates urgency with 'unusual activity' claim",
                        "Generic greeting with no personalization",
                        "Vague about the specific unusual activity"
                    ]
                }
            ];

            // Quiz state
            window.quizState = {
                currentEmail: 0,
                score: 0,
                answers: []
            };

            // Start the quiz
            window.startSpotPhishQuiz = function() {
                document.getElementById('quiz-intro').style.display = 'none';
                document.getElementById('quiz-container').style.display = 'block';
                showEmail(0);
            };

            // Show email
            window.showEmail = function(emailIndex) {
                const email = window.phishingEmails[emailIndex];
                const container = document.getElementById('question-container');
                
                container.innerHTML = `
                    <div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); margin-bottom: 20px;">
                        <h3 style="margin-bottom: 20px; color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 20px;">Email ${emailIndex + 1} of 5</h3>
                        <p style="margin-bottom: 20px; font-size: 16px; color: #666;">Analyze this email and determine if it's legitimate or a phishing attempt:</p>
                        
                        <div style="margin-bottom: 25px;">
                            ${email.body}
                        </div>
                        
                        <div style="display: flex; gap: 20px; justify-content: center; margin-bottom: 20px;">
                            <button onclick="selectAnswer(${emailIndex}, false)" class="btn btn-primary" style="background-color: #28a745; color: white; font-size: 16px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; min-width: 140px; box-shadow: 0 0 20px rgba(40, 167, 69, 0.6);">Legitimate</button>
                            <button onclick="selectAnswer(${emailIndex}, true)" class="btn btn-primary" style="background-color: #dc3545; color: white; font-size: 16px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; min-width: 140px; box-shadow: 0 0 20px rgba(220, 53, 69, 0.6);">Phishing</button>
                        </div>
                        <div id="answer-feedback" style="margin-top: 20px; display: none;">
                            <div id="feedback-content"></div>
                        </div>
                    </div>
                `;
                
                document.getElementById('question-counter').textContent = `Email ${emailIndex + 1} of 5`;
                document.getElementById('next-question-btn').style.display = 'none';
            };

            // Select answer
            window.selectAnswer = function(emailIndex, selectedAnswer) {
                const email = window.phishingEmails[emailIndex];
                const isCorrect = selectedAnswer === email.isPhishing;
                
                if (isCorrect) {
                    window.quizState.score++;
                }
                
                window.quizState.answers[emailIndex] = selectedAnswer;
                
                // Show feedback
                const feedbackDiv = document.getElementById('answer-feedback');
                const feedbackContent = document.getElementById('feedback-content');
                
                let feedbackHTML = `
                    <div style="padding: 20px; border-radius: 8px; background: ${isCorrect ? '#d4edda' : '#f8d7da'}; color: ${isCorrect ? '#155724' : '#721c24'}; border: 1px solid ${isCorrect ? '#c3e6cb' : '#f5c6cb'}; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <i class="fas ${isCorrect ? 'fa-check-circle' : 'fa-times-circle'}" style="font-size: 20px; margin-right: 10px;"></i>
                            <strong style="font-size: 18px;">${isCorrect ? 'Correct!' : 'Incorrect!'}</strong>
                        </div>
                        <p style="margin: 0; font-size: 16px; line-height: 1.6; margin-bottom: 15px;">
                            This email is <strong>${email.isPhishing ? 'PHISHING' : 'LEGITIMATE'}</strong>.
                        </p>
                `;
                
                if (email.isPhishing && email.redFlags) {
                    feedbackHTML += `
                        <div style="margin-top: 15px;">
                            <strong>Red Flags Found:</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                ${email.redFlags.map(flag => `<li>${flag}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                } else if (!email.isPhishing && email.legitimateFeatures) {
                    feedbackHTML += `
                        <div style="margin-top: 15px;">
                            <strong>Legitimate Features:</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                ${email.legitimateFeatures.map(feature => `<li>${feature}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
                
                feedbackHTML += '</div>';
                feedbackContent.innerHTML = feedbackHTML;
                
                feedbackDiv.style.display = 'block';
                document.getElementById('next-question-btn').style.display = 'inline-block';
                
                // Disable answer buttons
                const buttons = document.querySelectorAll('#question-container button');
                buttons.forEach(btn => {
                    if (btn.onclick) {
                        btn.disabled = true;
                        btn.style.opacity = '0.6';
                    }
                });
            };

            // Next question
            window.nextQuestion = function() {
                window.quizState.currentEmail++;
                
                if (window.quizState.currentEmail >= window.phishingEmails.length) {
                    showResults();
                } else {
                    showEmail(window.quizState.currentEmail);
                }
            };

            // Show results
            window.showResults = function() {
                document.getElementById('quiz-container').style.display = 'none';
                document.getElementById('quiz-results').style.display = 'block';
                
                const score = window.quizState.score;
                document.getElementById('final-score').textContent = score;
                
                let message = '';
                if (score === 5) {
                    message = 'Excellent! You have excellent phishing detection skills! 🎉';
                } else if (score >= 3) {
                    message = 'Good job! You have good phishing detection skills, but there\'s room for improvement. 👍';
                } else {
                    message = 'You need to improve your phishing detection skills. Review the course materials and try again. 📚';
                }
                
                document.getElementById('score-message').textContent = message;
                
                // Send results to admin
                sendResultsToAdmin(score);
            };

            // Send results to admin
            window.sendResultsToAdmin = function(score) {
                const userData = JSON.parse(localStorage.getItem('cybertech_user') || '{}');
                
                // Create unique user identifier
                const userId = userData.id || userData.username || 'unknown';
                const username = userData.username || userData.name || 'Unknown User';
                
                const assessmentResult = {
                    id: Date.now().toString(),
                    userId: userId,
                    username: username,
                    courseName: 'Phishing Awareness',
                    exerciseName: 'Spot the Phish Quiz',
                    score: score,
                    totalQuestions: 5,
                    percentage: (score / 5) * 100,
                    completedAt: new Date().toISOString(),
                    answers: window.quizState.answers
                };
                
                console.log('Saving assessment result for user:', { userId, username, score });
                
                // Save to assessment results
                const existingResults = JSON.parse(localStorage.getItem('cybertech_assessment_results') || '[]');
                existingResults.push(assessmentResult);
                localStorage.setItem('cybertech_assessment_results', JSON.stringify(existingResults));
                
                console.log('✅ Assessment results sent to admin:', assessmentResult);
            };

            // Show completed exercise results for users who already finished
            window.showCompletedExerciseResults = function(completedResult) {
                console.log('Showing completed exercise results for user:', completedResult.username);
                
                // Remove any existing quiz modal first
                const existingModal = document.getElementById('spot-phish-quiz-modal');
                if (existingModal) {
                    existingModal.remove();
                }
                
                // Create modal that matches the course page design
                let modal = document.getElementById('spot-phish-quiz-modal');
                if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'spot-phish-quiz-modal';
                    modal.className = 'video-modal';
                    modal.style.cssText = `
                        display: none;
                        position: fixed;
                        z-index: 1000;
                        left: 0;
                        top: 0;
                        width: 100%;
                        height: 100%;
                        background-color: rgba(0, 0, 0, 0.8);
                    `;
                    
                    const modalContent = `
                        <div class="video-modal-content" style="background-color: #fefefe; margin: 5% auto; padding: 20px; width: 90%; max-width: 800px; border-radius: 8px; position: relative;">
                            <div class="video-modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0; font-family: 'Poppins', sans-serif; font-weight: 600;">Spot the Phish Exercise - Completed</h3>
                                <button onclick="closeSpotPhishQuiz()" style="background: none; border: none; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa;">&times;</button>
                            </div>
                            
                            <div class="video-modal-body" style="text-align: center; padding: 30px;">
                                <div style="margin-bottom: 30px;">
                                    <i class="fas fa-trophy" style="font-size: 48px; color: #00c9a7; margin-bottom: 20px;"></i>
                                    <h2 style="color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; margin-bottom: 15px;">Exercise Already Completed!</h2>
                                    <p style="font-size: 16px; color: #666; line-height: 1.6; margin-bottom: 30px;">You have already completed this exercise. Here are your results:</p>
                                </div>
                                
                                <div id="completed-score-display" style="margin-bottom: 30px;">
                                    <div style="font-size: 48px; color: #4e54c8; margin: 20px 0; font-weight: 700;">
                                        <span id="completed-final-score">${completedResult.score}</span>/5
                                    </div>
                                    <p id="completed-score-message" style="font-size: 18px; color: #666; line-height: 1.6; margin-bottom: 20px;">
                                        ${completedResult.score === 5 ? 'Excellent! You have excellent phishing detection skills! 🎉' : 
                                          completedResult.score >= 3 ? 'Good job! You have good phishing detection skills, but there\'s room for improvement. 👍' : 
                                          'You need to improve your phishing detection skills. Review the course materials and try again. 📚'}
                                    </p>
                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 20px;">
                                        <p style="margin: 0; color: #666; font-size: 14px;">
                                            <strong>Completed on:</strong> ${new Date(completedResult.completedAt).toLocaleDateString()} at {new Date(completedResult.completedAt).toLocaleTimeString()}
                                        </p>
                                        <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">
                                            <strong>Percentage:</strong> ${completedResult.percentage}%
                                        </p>
                                    </div>
                                </div>
                                
                                <button onclick="closeSpotPhishQuiz()" class="btn btn-primary" style="background-color: #00c9a7; color: white; font-size: 18px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 0 20px rgba(0, 201, 167, 0.6);">Close Results</button>
                            </div>
                        </div>
                    `;
                    
                    modal.innerHTML = modalContent;
                    document.body.appendChild(modal);
                }
                
                modal.style.display = 'block';
            };

            // Close quiz
            window.closeSpotPhishQuiz = function() {
                const modal = document.getElementById('spot-phish-quiz-modal');
                if (modal) {
                    modal.style.display = 'none';
                }
                
                // Reset quiz state
                window.quizState = {
                    currentEmail: 0,
                    score: 0,
                    answers: []
                };
                
                // Reset modal to show intro page when reopened
                const quizIntro = document.getElementById('quiz-intro');
                const quizContainer = document.getElementById('quiz-container');
                const quizResults = document.getElementById('quiz-results');
                
                if (quizIntro) quizIntro.style.display = 'block';
                if (quizContainer) quizContainer.style.display = 'none';
                if (quizResults) quizResults.style.display = 'none';
            };

            // Main function to open the Spot the Phish exercise - NO VIDEO, JUST QUIZ
            window.openSpotThePhishExercise = function() {
                console.log('Opening Spot the Phish exercise with course styling...');
                
                // STOP ANY PLAYING VIDEOS IMMEDIATELY
                const allVideos = document.querySelectorAll('video');
                allVideos.forEach(function(video) {
                    console.log('◆◆Stopping video playback for exercise');
                    video.pause();
                    video.currentTime = 0;
                    video.muted = true;
                });
                
                // Close any open video modals
                const videoModal = document.getElementById('videoModal');
                if (videoModal) {
                    videoModal.style.display = 'none';
                }
                
                // Check if user is admin
                const currentUser = JSON.parse(localStorage.getItem('cybertech_user') || '{}');
                const isAdmin = currentUser.role === 'admin' || currentUser.isAdmin === true;
                
                console.log('Current user:', currentUser);
                console.log('Is admin:', isAdmin);
                
                // Check if user has already completed the exercise
                const assessmentResults = JSON.parse(localStorage.getItem('cybertech_assessment_results') || '[]');
                console.log('All assessment results:', assessmentResults);
                
                // Try multiple ways to identify the user
                const userCompletedExercise = assessmentResults.find(result => {
                    const userIdMatch = result.userId === currentUser.id;
                    const usernameMatch = result.userId === currentUser.username;
                    const displayNameMatch = result.username === currentUser.username;
                    
                    const isMatch = (userIdMatch || usernameMatch || displayNameMatch) && 
                                   result.exerciseName === 'Spot the Phish Quiz' &&
                                   result.courseName === 'Phishing Awareness';
                    
                    if (isMatch) {
                        console.log('Found matching result:', {
                            resultUserId: result.userId,
                            resultUsername: result.username,
                            currentUserId: currentUser.id,
                            currentUsername: currentUser.username,
                            matchType: userIdMatch ? 'userId' : usernameMatch ? 'username' : 'displayName'
                        });
                    }
                    
                    return isMatch;
                });
                
                console.log('User completed exercise:', userCompletedExercise);
                
                // If user is not admin and has completed exercise, show results
                if (!isAdmin && userCompletedExercise) {
                    console.log('User has already completed exercise - showing results');
                    showCompletedExerciseResults(userCompletedExercise);
                    return;
                }
                
                // Check if THIS SPECIFIC USER has completed the exercise
                if (!isAdmin && assessmentResults.length > 0) {
                    const phishingResults = assessmentResults.filter(result => 
                        result.exerciseName === 'Spot the Phish Quiz' &&
                        result.courseName === 'Phishing Awareness'
                    );
                    
                    // Find result for THIS specific user
                    const userResult = phishingResults.find(result => 
                        result.userId === currentUser.id || 
                        result.userId === currentUser.username || 
                        result.username === currentUser.username
                    );
                    
                    if (userResult) {
                        console.log('This specific user has completed the exercise:', userResult);
                        showCompletedExerciseResults(userResult);
                        return;
                    } else {
                        console.log('This user has not completed the exercise yet - showing quiz');
                    }
                }
                
                // If we reach here, user can take the quiz (either admin or new user)
                console.log('User can take the quiz - creating quiz modal');
                
                // Create modal that matches the course page design
                let modal = document.getElementById('spot-phish-quiz-modal');
                if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'spot-phish-quiz-modal';
                    modal.className = 'video-modal';
                    modal.style.cssText = `
                        display: none;
                        position: fixed;
                        z-index: 1000;
                        left: 0;
                        top: 0;
                        width: 100%;
                        height: 100%;
                        background-color: rgba(0, 0, 0, 0.8);
                    `;
                    
                    const modalContent = `
                        <div class="video-modal-content" style="background-color: #fefefe; margin: 5% auto; padding: 20px; width: 90%; max-width: 800px; border-radius: 8px; position: relative;">
                            <div class="video-modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #333; margin: 0; font-family: 'Poppins', sans-serif; font-weight: 600;">Spot the Phish Interactive Exercise</h3>
                                <button onclick="closeSpotPhishQuiz()" style="background: none; border: none; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa;">&times;</button>
                            </div>
                            
                            <div class="video-modal-body">
                                <div id="quiz-intro" style="display: block; text-align: center; padding: 20px;">
                                    <div style="margin-bottom: 30px;">
                                        <i class="fas fa-puzzle-piece" style="font-size: 48px; color: #4e54c8; margin-bottom: 20px;"></i>
                                        <h2 style="color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; margin-bottom: 15px;">Test Your Phishing Detection Skills</h2>
                                        <p style="font-size: 16px; color: #666; line-height: 1.6; margin-bottom: 20px;">You'll be shown 5 different email scenarios. Your task is to identify which ones are legitimate and which ones are phishing attempts.</p>
                                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                                            <h4 style="color: #4e54c8; margin-bottom: 15px;">Look for these red flags:</h4>
                                            <ul style="text-align: left; color: #666; line-height: 1.8;">
                                                <li>Suspicious sender addresses</li>
                                                <li>Urgent language or threats</li>
                                                <li>Poor grammar and spelling</li>
                                                <li>Suspicious links or attachments</li>
                                                <li>Requests for personal information</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <button onclick="startSpotPhishQuiz()" class="btn btn-primary" style="background-color: #4e54c8; color: white; font-size: 18px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 0 20px rgba(78, 84, 200, 0.6);">Start Exercise</button>
                                </div>
                                
                                <div id="quiz-container" style="display: none;">
                                    <div id="question-container" style="margin-bottom: 30px;">
                                        <!-- Questions will be inserted here -->
                                    </div>
                                    
                                    <div id="quiz-controls" style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                                        <span id="question-counter" style="font-size: 16px; color: #666; font-weight: 500;">Email 1 of 5</span>
                                        <button id="next-question-btn" onclick="nextQuestion()" class="btn btn-primary" style="background-color: #4e54c8; color: white; font-size: 16px; padding: 12px 25px; border-radius: 30px; border: none; cursor: pointer; margin-left: 15px; display: none;">Next Email</button>
                                    </div>
                                </div>
                                
                                <div id="quiz-results" style="display: none; text-align: center; padding: 30px;">
                                    <div style="margin-bottom: 30px;">
                                        <i class="fas fa-trophy" style="font-size: 48px; color: #00c9a7; margin-bottom: 20px;"></i>
                                        <h2 style="color: #333; font-family: 'Poppins', sans-serif; font-weight: 600; margin-bottom: 15px;">Exercise Complete!</h2>
                                    </div>
                                    
                                    <div id="score-display" style="margin-bottom: 30px;">
                                        <div style="font-size: 48px; color: #4e54c8; margin: 20px 0; font-weight: 700;">
                                            <span id="final-score">0</span>/5
                                        </div>
                                        <p id="score-message" style="font-size: 18px; color: #666; line-height: 1.6; margin-bottom: 20px;">Score message will appear here</p>
                                    </div>
                                    
                                    <button onclick="closeSpotPhishQuiz()" class="btn btn-primary" style="background-color: #00c9a7; color: white; font-size: 18px; padding: 15px 30px; border-radius: 30px; border: none; cursor: pointer; box-shadow: 0 0 20px rgba(0, 201, 167, 0.6);">Close Exercise</button>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    modal.innerHTML = modalContent;
                    document.body.appendChild(modal);
                }
                
                modal.style.display = 'block';
            };

            // Email-based exercise for Spot the Phish - 5 QUESTIONS
            window.phishingEmails = [
                {
                    sender: "Amazon Customer Service <amazon-support@amazn-services.com>",
                    subject: "Urgent: Your Amazon Account Has Been Suspended",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Amazon Customer Service &lt;amazon-support@amazn-services.com&gt;</div>
                            <div><strong>Subject:</strong> Urgent: Your Amazon Account Has Been Suspended</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <p>Dear Valued Customer,</p>
                            <p>We regret to inform you that your Amazon account has been temporarily suspended due to failed verification of your billing information.</p>
                            <p>To restore your account access, please verify your information by clicking the link below:</p>
                            <p><a href="#" style="color: blue; text-decoration: underline;">https://amazn-account-verify.com/restore-account</a></p>
                            <p>If you do not verify your account within 24 hours, your account will be permanently deactivated.</p>
                            <p>Thank you for your cooperation.</p>
                            <p>Amazon Customer Service Team</p>
                        </div>
                    </div>`,
                    isPhishing: true,
                    redFlags: [
                        "Misspelled domain in email address (amazn-services.com instead of amazon.com)",
                        "Creates urgency with threats of account suspension",
                        "Suspicious link URL (amazn-account-verify.com is not an Amazon domain)",
                        "Generic greeting ('Valued Customer' instead of your name)"
                    ]
                },
                {
                    sender: "PayPal <service@paypal.com>",
                    subject: "Your account has been limited until we hear from you",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> PayPal &lt;service@paypal.com&gt;</div>
                            <div><strong>Subject:</strong> Your account has been limited until we hear from you</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <img src="https://www.paypalobjects.com/webstatic/i/logo/rebrand/ppcom.svg" alt="PayPal Logo" style="height: 40px; margin-bottom: 15px;">
                            <p>We noticed some unusual activity in your account. To ensure your account safety, we've temporarily limited some features.</p>
                            <p>Please log in to your PayPal account to verify your information:</p>
                            <p style="text-align: center;">
                                <a href="https://www.paypal.com/signin" style="background-color: #0070ba; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">Log In to PayPal</a>
                            </p>
                            <p>If you don't recognize this activity, please secure your account by changing your password after logging in.</p>
                            <p>Thank you for your prompt attention to this matter.</p>
                            <p>PayPal Customer Service</p>
                        </div>
                    </div>`,
                    isPhishing: false,
                    legitimateFeatures: [
                        "Correct sender domain (paypal.com)",
                        "Link goes to the actual PayPal website",
                        "No request for personal information via email",
                        "Professional design with proper branding",
                        "No spelling or grammar errors"
                    ]
                },
                {
                    sender: "Bank of America <secure@bankofamerica.com>",
                    subject: "URGENT: Unauthorized Access Detected",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Bank of America &lt;secure@bankofamerica.com&gt;</div>
                            <div><strong>Subject:</strong> URGENT: Unauthorized Access Detected</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <img src="https://1000logos.net/wp-content/uploads/2016/10/Bank-of-America-Logo.png" alt="Bank of America Logo" style="height: 40px; margin-bottom: 15px;">
                            <p>Dear Valued Customer,</p>
                            <p>Our security system has detected unauthorized access attempts to your online banking account. For your protection, we have temporarily restricted access to your account.</p>
                            <p>To restore access immediately, please verify your identity by clicking the link below and confirming your account details:</p>
                            <p><a href="#" style="color: blue; text-decoration: underline;">https://secure-bankofamerica.com-verify.us/login</a></p>
                            <p>If you do not verify your account within 24 hours, your account will be suspended.</p>
                            <p>Thank you for your cooperation.</p>
                            <p>Bank of America Security Team</p>
                        </div>
                    </div>`,
                    isPhishing: true,
                    redFlags: [
                        "Suspicious URL (secure-bankofamerica.com-verify.us is not a Bank of America domain)",
                        "Creates urgency with 'URGENT' in the subject and threats of account suspension",
                        "Generic greeting ('Valued Customer')",
                        "Requests verification of account details via a link",
                        "Threatening tone with time pressure (24 hours)"
                    ]
                },
                {
                    sender: "Netflix <info@mailer.netflix.com>",
                    subject: "Your Netflix payment didn't go through",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Netflix &lt;info@mailer.netflix.com&gt;</div>
                            <div><strong>Subject:</strong> Your Netflix payment didn't go through</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1200px-Netflix_2015_logo.svg.png" alt="Netflix Logo" style="height: 40px; margin-bottom: 15px;">
                            <p>Hi there,</p>
                            <p>We're having some trouble with your current billing information. We'll try again, but to avoid any interruption of your service, please update your payment details.</p>
                            <p style="text-align: center;">
                                <a href="https://www.netflix.com/YourAccount" style="background-color: #e50914; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">Update Payment Information</a>
                            </p>
                            <p>If you need help, visit the <a href="https://help.netflix.com/">Netflix Help Center</a>.</p>
                            <p>–Your friends at Netflix</p>
                        </div>
                    </div>`,
                    isPhishing: false,
                    legitimateFeatures: [
                        "Correct sender domain (mailer.netflix.com is a legitimate Netflix email domain)",
                        "Link goes to the actual Netflix website",
                        "Professional design with proper branding",
                        "No urgent threats or extreme consequences mentioned",
                        "Provides alternative help options"
                    ]
                },
                {
                    sender: "Microsoft Security Team <security@microsoft.com>",
                    subject: "Your Microsoft Account: Action Required",
                    body: `<div style="border: 1px solid #ddd; padding: 15px; font-family: Arial, sans-serif; background: white; border-radius: 5px;">
                        <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
                            <div><strong>From:</strong> Microsoft Security Team &lt;security@microsoft.com&gt;</div>
                            <div><strong>Subject:</strong> Your Microsoft Account: Action Required</div>
                            <div><strong>Date:</strong> ${new Date().toLocaleDateString()}</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <p>Hello,</p>
                            <p>We detected unusual sign-in activity on your Microsoft account. To secure your account, we've temporarily limited access.</p>
                            <p>Please verify your identity by confirming your account details at:</p>
                            <p><a href="#" style="color: blue; text-decoration: underline;">https://security-microsoft-verify.net/account</a></p>
                            <p>This link will expire in 24 hours.</p>
                            <p>Microsoft Security</p>
                        </div>
                    </div>`,
                    isPhishing: true,
                    redFlags: [
                        "Suspicious link URL (security-microsoft-verify.net is not a Microsoft domain)",
                        "Creates urgency with 'unusual activity' claim",
                        "Generic greeting with no personalization",
                        "Vague about the specific unusual activity"
                    ]
                }
            ];

            // Initialize quiz state
            window.quizState = {
                currentEmail: 0,
                score: 0,
                answers: []
            };

            // Start quiz function
            window.startSpotPhishQuiz = function() {
                document.getElementById('quiz-intro').style.display = 'none';
                document.getElementById('quiz-container').style.display = 'block';
                showEmail(0);
            };

            // Show email function
            window.showEmail = function(emailIndex) {
                const email = window.phishingEmails[emailIndex];
                const container = document.getElementById('question-container');
                
                document.getElementById('question-counter').textContent = `Email ${emailIndex + 1} of 5`;
                
                const emailHTML = `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #333; margin-bottom: 20px; font-family: 'Poppins', sans-serif;">Analyze this email:</h3>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            ${email.body}
                        </div>
                        <div style="text-align: center;">
                            <h4 style="color: #4e54c8; margin-bottom: 15px;">Is this email legitimate or a phishing attempt?</h4>
                            <button onclick="selectAnswer(${emailIndex}, true)" class="btn btn-primary" style="background-color: #28a745; color: white; font-size: 16px; padding: 12px 25px; border-radius: 30px; border: none; cursor: pointer; margin-right: 10px;">Legitimate</button>
                            <button onclick="selectAnswer(${emailIndex}, false)" class="btn btn-primary" style="background-color: #dc3545; color: white; font-size: 16px; padding: 12px 25px; border-radius: 30px; border: none; cursor: pointer;">Phishing</button>
                        </div>
                    </div>
                `;
                
                container.innerHTML = emailHTML;
            };

            // Select answer function
            window.selectAnswer = function(emailIndex, userAnswer) {
                const email = window.phishingEmails[emailIndex];
                const isCorrect = userAnswer === email.isPhishing;
                
                if (isCorrect) {
                    window.quizState.score++;
                }
                
                window.quizState.answers.push({
                    emailIndex: emailIndex,
                    userAnswer: userAnswer,
                    correctAnswer: email.isPhishing,
                    isCorrect: isCorrect
                });
                
                // Show feedback
                const container = document.getElementById('question-container');
                const feedbackDiv = document.createElement('div');
                feedbackDiv.id = 'feedback-div';
                feedbackDiv.style.cssText = `
                    background: ${isCorrect ? '#d4edda' : '#f8d7da'};
                    color: ${isCorrect ? '#155724' : '#721c24'};
                    padding: 20px;
                    border-radius: 12px;
                    margin-top: 25px;
                    text-align: center;
                    border: 2px solid ${isCorrect ? '#28a745' : '#dc3545'};
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    font-family: 'Poppins', sans-serif;
                `;
                
                let feedbackHTML = `
                    <h4 style="margin: 0 0 15px 0; color: ${isCorrect ? '#155724' : '#721c24'}; font-size: 20px; font-weight: 600;">
                        ${isCorrect ? '✅ Correct!' : '❌ Incorrect!'}
                    </h4>
                    <p style="margin: 0 0 15px 0; font-weight: 500; font-size: 16px;">
                        This email is <strong>${email.isPhishing ? 'a phishing attempt' : 'legitimate'}</strong>.
                    </p>
                `;
                
                if (email.isPhishing && email.redFlags) {
                    feedbackHTML += `
                        <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #dc3545;">
                            <h5 style="margin: 0 0 10px 0; color: #dc3545; font-weight: 600;">🚨 Red Flags Found:</h5>
                            <ul style="text-align: left; margin: 10px 0; padding-left: 20px; line-height: 1.6;">
                                ${email.redFlags.map(flag => `<li style="margin-bottom: 5px;">${flag}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                } else if (!email.isPhishing && email.legitimateFeatures) {
                    feedbackHTML += `
                        <div style="background: rgba(255,255,255,0.8); padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #28a745;">
                            <h5 style="margin: 0 0 10px 0; color: #28a745; font-weight: 600;">✅ Legitimate Features:</h5>
                            <ul style="text-align: left; margin: 10px 0; padding-left: 20px; line-height: 1.6;">
                                ${email.legitimateFeatures.map(feature => `<li style="margin-bottom: 5px;">${feature}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
                
                feedbackDiv.innerHTML = feedbackHTML;
                
                // Add the feedback div to the container
                container.appendChild(feedbackDiv);
                
                // Show the next button
                document.getElementById('next-question-btn').style.display = 'inline-block';
                
                // Disable answer buttons
                const buttons = document.querySelectorAll('#question-container button');
                buttons.forEach(btn => {
                    if (btn.onclick) {
                        btn.disabled = true;
                        btn.style.opacity = '0.6';
                    }
                });
            };
        </script>
    <!-- Video Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-content">
            <div class="video-modal-header">
                <h3 id="videoTitle">Video Title</h3>
                <button class="close-video-modal" onclick="closeVideoModal()">&times;</button>
            </div>
            <div class="video-modal-body">
                <div class="video-container" style="position: relative; background: #000; min-height: 400px;">
                    <video id="courseVideo" controls controlsList="nodownload" playsinline preload="auto" style="width: 100%; height: 400px; background: #000; display: block; object-fit: contain;">
                        <source src="videos/courses/Phishing 1.mp4" type="video/mp4">
                        <p>Your browser does not support the video tag.</p>
                    </video>
                </div>
                <div class="video-info">
                    <p id="videoDuration">Duration: <span id="durationText">0 min</span></p>
                    <p>Click play to start the lesson. You can pause and resume at any time.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // SIMPLIFIED VIDEO OVERRIDE: Only block specific lessons, allow others
        window.openVideoModal = function(title, videoId, duration) {
            // Block video ONLY for reading lessons and Spot the Phish exercise
                          const readingLessons = [
                  'Common Types of Phishing Attacks'
              ];
            
            const exerciseLessons = [
                'Interactive Exercise: Spot the Phish',
                'Spot the Phish'
            ];
            
            // Block videos for reading lessons (show content instead)
            if (readingLessons.some(lesson => title.includes(lesson) || lesson.includes(title))) {
                console.log('📖 This is a reading lesson, not showing video');
                return;
            }
            
            // Block videos for exercises (show quiz instead)
            if (exerciseLessons.some(exercise => title.includes(exercise) || exercise.includes(title))) {
                console.log('🎯 This is an exercise, opening quiz instead');
                if (typeof window.openSpotThePhishExercise === 'function') {
                    window.openSpotThePhishExercise();
                }
                return;
            }
            
            // For ALL OTHER videos, show the video modal
            console.log('🎥 Opening video modal for:', title);
            
            const modal = document.getElementById('videoModal');
            const videoTitle = document.getElementById('videoTitle');
            const durationText = document.getElementById('durationText');
            const video = document.getElementById('courseVideo');
            
            if (!modal || !videoTitle || !durationText || !video) {
                console.error('❌ Video modal elements not found');
                return;
            }
            
            // Set video details
            videoTitle.textContent = title;
            durationText.textContent = duration + ' min';
            
            // Show modal first
            modal.style.display = 'block';
            
            // Reset video element
            video.pause();
            video.src = '';
            video.load();
            
            // Set video properties for better display
            video.style.display = 'block';
            video.style.width = '100%';
            video.style.height = '400px';
            video.style.backgroundColor = '#000';
            video.style.objectFit = 'contain';
            video.style.opacity = '1';
            video.style.visibility = 'visible';
            
            // Try to load admin uploaded video
            const userVideos = JSON.parse(localStorage.getItem('cybertech_user_videos') || '[]');
            console.log('🔍 Looking for admin videos:', userVideos.length);
            
            // Find matching admin video
            let matchedVideo = userVideos.find(v => 
                v.isUploadedFile === true &&
                (v.title === title || v.lessonName === title || title.includes(v.title) || v.title.includes(title))
            );
            
            // Try broader search if no exact match
            if (!matchedVideo) {
                matchedVideo = userVideos.find(v => 
                    v.isUploadedFile === true &&
                    v.courseName && v.courseName.toLowerCase().includes('phishing')
                );
            }
            
            console.log('🎯 Matched video:', matchedVideo);
            
            if (matchedVideo && matchedVideo.videoUrl) {
                console.log('✅ Loading admin uploaded video:', matchedVideo.title);
                
                try {
                    // Handle different video URL types
                    if (matchedVideo.videoUrl.startsWith('data:')) {
                        // Base64 encoded video
                        video.src = matchedVideo.videoUrl;
                    } else if (matchedVideo.videoUrl.startsWith('blob:')) {
                        // Blob URL
                        video.src = matchedVideo.videoUrl;
                    } else {
                        // Regular URL
                        video.src = matchedVideo.videoUrl;
                    }
                    
                    // Update title to show it's admin video
                    videoTitle.textContent = matchedVideo.title + ' (Admin Video)';
                    videoTitle.style.color = '#4CAF50';
                    durationText.textContent = matchedVideo.duration + ' min';
                    
                    // Load and play video
                    video.load();
                    
                    video.oncanplay = function() {
                        console.log('🎬 Admin video ready to play');
                        video.play().catch(function(error) {
                            console.error('❌ Error playing admin video:', error);
                        });
                    };
                    
                    video.onerror = function(e) {
                        console.error('❌ Admin video error:', e);
                        // Fallback to default video
                        loadDefaultVideo();
                    };
                    
                } catch (error) {
                    console.error('❌ Error loading admin video:', error);
                    loadDefaultVideo();
                }
                
            } else {
                console.log('⚠️ No admin video found, using default video');
                loadDefaultVideo();
            }
            
            function loadDefaultVideo() {
                // Load default video
                video.src = 'videos/courses/Phishing 1.mp4';
                videoTitle.textContent = title + ' (Sample Video)';
                videoTitle.style.color = '#666';
                durationText.textContent = duration + ' min';
                
                video.load();
                
                video.oncanplay = function() {
                    console.log('🎬 Default video ready to play');
                    video.play().catch(function(error) {
                        console.error('❌ Error playing default video:', error);
                    });
                };
                
                video.onerror = function(e) {
                    console.error('❌ Default video error:', e);
                    // Show error message
                    video.style.display = 'none';
                    const errorDiv = document.createElement('div');
                    errorDiv.style.cssText = `
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        height: 400px;
                        background: #f8f9fa;
                        color: #666;
                        text-align: center;
                        flex-direction: column;
                    `;
                    errorDiv.innerHTML = `
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 15px; color: #ffc107;"></i>
                        <h4>Video Not Available</h4>
                        <p>Please contact admin to upload video content for this lesson.</p>
                    `;
                    video.parentElement.appendChild(errorDiv);
                };
            }
        };

        // Close video modal function
        window.closeVideoModal = function() {
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('courseVideo');
            
            if (video) {
                video.pause();
                video.src = '';
                video.load();
            }
            
            if (modal) {
                modal.style.display = 'none';
            }
            
            // Clean up any error messages
            const errorDivs = document.querySelectorAll('.video-container > div:not(#video-loading)');
            errorDivs.forEach(div => {
                if (div.innerHTML.includes('Video Not Available')) {
                    div.remove();
                }
            });
            
            console.log('🔒 Video modal closed');
        };

        // Close video modal function
        window.closeVideoModal = function() {
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('courseVideo');
            
            if (video) {
                video.pause();
                video.src = '';
                video.load();
            }
            
            if (modal) {
                modal.style.display = 'none';
            }
            
            // Clean up any error messages
            const errorDivs = document.querySelectorAll('.video-container > div:not(#video-loading)');
            errorDivs.forEach(div => {
                if (div.innerHTML.includes('Video Not Available')) {
                    div.remove();
                }
            });
            
            console.log('🔒 Video modal closed');
        };

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: '#4CAF50',
                error: '#f44336',
                warning: '#ff9800',
                info: '#2196F3'
            };
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type] || colors.info};
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                max-width: 400px;
                word-wrap: break-word;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Video player functions
        function playVideo(videoId, title) {
            console.log('Playing video:', videoId, title);
            
            // Get video data from localStorage
            let videoData = localStorage.getItem(`video_data_${videoId}`);
            if (!videoData) {
                // Try alternate keys
                videoData = localStorage.getItem(`video_data_${videoId}_${title.replace(/\s+/g, '_')}`);
                if (!videoData) {
                    videoData = localStorage.getItem(`video_data_${title.replace(/\s+/g, '_')}`);
                }
            }
            
            if (!videoData) {
                console.error('Video data not found for:', title);
                showNotification('⚠️ Video not found. Please contact the administrator.', 'error');
                return;
            }
            
            const videoPlayer = document.getElementById('video-player');
            const playerModal = document.getElementById('video-player-modal');
            const playerTitle = document.getElementById('video-player-title');
            
            // Set video source and title
            videoPlayer.src = videoData;
            playerTitle.textContent = title;
            
            // Show modal
            playerModal.style.display = 'flex';
            
            // Play video
            videoPlayer.play().catch(error => {
                console.error('Error playing video:', error);
                showNotification('⚠️ Error playing video. Please try again.', 'error');
            });
        }
        
        function closeVideoPlayer() {
            const videoPlayer = document.getElementById('video-player');
            const playerModal = document.getElementById('video-player-modal');
            
            // Pause and reset video
            videoPlayer.pause();
            videoPlayer.currentTime = 0;
            videoPlayer.removeAttribute('src');
            
            // Hide modal
            playerModal.style.display = 'none';
        }
        
        // Close video player when clicking outside
        document.getElementById('video-player-modal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeVideoPlayer();
            }
        });
        
        // Keyboard shortcuts for video player
        document.addEventListener('keydown', function(event) {
            const playerModal = document.getElementById('video-player-modal');
            if (playerModal.style.display === 'flex') {
                const videoPlayer = document.getElementById('video-player');
                
                switch(event.key) {
                    case ' ': // Spacebar to play/pause
                        event.preventDefault();
                        if (videoPlayer.paused) {
                            videoPlayer.play();
                        } else {
                            videoPlayer.pause();
                        }
                        break;
                    case 'Escape': // Escape to close
                        closeVideoPlayer();
                        break;
                    case 'f': // F for fullscreen
                    case 'F':
                        if (videoPlayer.requestFullscreen) {
                            videoPlayer.requestFullscreen();
                        }
                        break;
                }
            }
        });
        </script>
    </body>
</html> 
